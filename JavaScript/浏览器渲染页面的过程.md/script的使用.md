# 在 HTML 中使用 javascript

## `<script>`元素

### 1.src 属性

1. 有 src 属性时，`<script>` 标签内的代码会被忽略。
2. src 也可连接网络上的 JS 文件，下载 JS 文件时不受同源策略的影响

### 2.普通标签

* 浏览器在 `解析` 文档时遇到 `<script>` 节点：
  
1. `JS 脚本写在标签内部`：会暂时停止 DOM 节点的解析，并开始 JS 代码的执行，等 JS 代码执行完毕后，继续进行 DOM 节点的解析
2. `JS 脚本是外部文件`： 会暂时停止 DOM 节点的解析，并立刻开始下载 JS 文件并执行，等 JS 代码执行完毕后，继续进行 DOM 节点的解析(`下载`和`执行` JS 外部文件都会阻塞后续 DOM 节点的`解析`)

* 预解析操作：现代浏览器是比较智能的，虽然`理论上` JS 脚本的下载和执行`都会阻塞`后续 DOM 节点的解析，但是浏览器会偷偷瞄一眼后面的 `script` `link` `img` 等类型的标签，会提前下载资源，不会傻傻的等非得解析到这些节点才去下载
* `<script>` 本质上也是一个 DOM 节点。浏览器从上至下解析文档。`<script>` 放在 body 前面就会在页面显示之前下载和执行 JS 文件。(十分不推荐，浏览器窗口显示空白的时间会变长)，一般建议放在 body 标签内部的最后面，这样就会在页面内容都呈现完毕之后再 `下载` 和 `执行` JS 文件

### 3.defer 延迟脚本

* 浏览器在 `解析` 文档时遇到带有 defer 属性的 `<script>` 节点，会开启新线程 `立即下载` 脚本文件，但是在 `文档解析` 完成之后才 `执行脚本文件`
* 使用这个属性的目的是: 表明脚本在`下载时不会影响 DOM 节点的解析`，脚本会被延迟到`整个页面都解析完毕之后`在运行。(`页面解析`完毕不是`页面加载`完毕)
* 多个设置了 defer 属性的脚本会 `按照书写的先后顺序执行`
* defer 相比较于普通的 script 标签的优点是：JS 文件的`下载`不会阻塞后续 DOM 的`解析`
* 仅适用于加载外部脚本文件，不能把 JS 脚本写在 script 中

### 4.async 异步脚本

* 浏览器在 `解析` 文档时遇到带有 async 属性的 `<script>` 标签。会开启新线程 `立即下载` 脚本文件，下载完毕之后立刻执行。
* 使用这个属性的目的是: 表明脚本在`下载时不会影响 DOM 节点的解析`。脚本会在下载完之后立刻执行。(因此建议在异步的脚本中不要包含修改 DOM 的行为, 因为不确定涉及的 DOM 此时有没有被解析到)
* 多个设置了 async 属性的脚本 `并不会按照书写的先后顺序执行`，因此保证多个异步脚本之间互不依赖很重要。
* 因为 async 的`下载完立刻执行`与`不会按照书写的先后顺序执行`这两个特点，在 WEB 项目中不推荐使用
* 仅适用于加载外部脚本文件，不能把 JS 脚本写在 script 中

### 5.动态引入的标签

* 使用 `document.createElement` 创建的 `script` 标签，默认 `async = true defer = false`
* 即使把 `async` 和 `defer` 都设置为 `false`。 动态创建的标签也不会像写在 `HTML` 文件中的 `script` 标签(下载和执行都会阻塞后续 DOM 的解析)一样。动态创建的 `script` 加载过程一定是异步(无法变成同步)

### 6. type

* type 为 module 时，代码会被当成 ES6 模块，而且只有这时代码中才能出现 import 和 export 关键字

## ```<noscript>```

* 标签里面的内容只有特定情况下才会显示

1. 浏览器不支持脚本
2. 浏览器支持脚本，但是脚本被禁用
