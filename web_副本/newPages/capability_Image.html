<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
		<title></title>
		<link href="../css/mui.css" rel="stylesheet" />
		<link href="../css/iconfont.css" rel="stylesheet" />
		<link href="../css/Common.css" rel="stylesheet" />
		<link href="../css/theme_normal.css" rel="stylesheet" />
		<style>
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a id="back" class="mui-icon iconfont icon-back1"></a>
			<h1 id="title" class="mui-title" data-text="WEB_image_setting">&nbsp;</h1>
		</header>
		<div class="mui-content">
			<ul class="mui-table-view mui-hidden" id="baseUl">
				<!--宽动态-->
				<li class="mui-table-view-cell mui-hidden" id="settings_WDR">
					<a class="mui-navigate-right" data-text="WEB_device_manager_WideDynamic_setting">&nbsp;</a>
				</li>
				<!--智能补光-->
				<li class="mui-table-view-cell mui-hidden" id="settings_IntelligentLight">
					<a class="mui-navigate-right" data-text="WEB_Intelligent_light_supply">&nbsp;</a>
				</li>
				<!--昼夜模式-->
				<li class="mui-table-view-cell mui-hidden" id="settings_DayNight">
					<a class="mui-navigate-right" data-text="WEB_dayNightMode">&nbsp;</a>
				</li>
			</ul>

		</div>

		<script src="../js/dsbridge.min.js"></script>
		<script src="../js/common.js"></script>
		<script src="../js/libs/md5.js"></script>
		<script src="../js/libs/jquery-3.4.1.min.js"></script>
		<script src="../js/libs/sha2.js"></script>
		<script src="../js/resource.js"></script>
		<script src="../js/Utils.js"></script>
		<script src="../js/mui.js"></script>
		<script src="../js/immersed.js"></script>
		<script src="../js/customSetting.js"></script>
		<script src="../js/loadCss.js "></script>
    <script id="langScript"></script>
		<script>
			checkType(localStorage.AppType); //加载特定样式
			var isShowNoFunction; //没功能占位图展示
			var capabilityDataObj;
			mui.init();
			var typeLan = initLang();
			langTip = typeLan.lang;

			initData();
			initEvent();

			function initData() {
				isShowNoFunction = true;
				SendAjax(LAPI.ImageCapabilities, 'get', function(code, data) {
					dsBridgeFuncSyn.dismiss();
					if(code == 0) {
						//NVR通道暂不支持宽动态和昼夜模式
						var setImageCapabilities = deepCopy(data);
						capabilityDataObj = {
							capacityData: data
						};
							//宽动态
							if(setImageCapabilities.Exposure) {
								if(setImageCapabilities.Exposure.WideDynamic && setImageCapabilities.Exposure.WideDynamic.SupportWideDynamicCfg == 1) {
									isShowNoFunction = false;
									$("#settings_WDR").removeClass("mui-hidden");
								}
							}

							//昼夜模式
							if(setImageCapabilities.Exposure) {
								if(setImageCapabilities.Exposure.DayNight && setImageCapabilities.Exposure.DayNight.DayNightModeNum != 0 && setImageCapabilities.Exposure.DayNight.SupportDayNightCfg == 1) {
									isShowNoFunction = false;
									$("#settings_DayNight").removeClass("mui-hidden");
								} else {
									$("#settings_DayNight").remove();
								}
							} else {
								$("#settings_DayNight").remove();
							}


						//智能补光
						if(setImageCapabilities.LampCtrl) {
							if(setImageCapabilities.LampCtrl.LampNum != 0) {
								isShowNoFunction = false;
								$("#settings_IntelligentLight").removeClass("mui-hidden");
							} else {
								$("#settings_IntelligentLight").remove();
							}
						} else {
							$("#settings_IntelligentLight").remove();
						}

						if(isShowNoFunction) {
							//TODO:无功能占位图
							addBitmap(1, langTip["WEB_noConfigAvailable"]);
						} else {
							$("#baseUl").removeClass("mui-hidden");
						}

					} else if(code == 4 || code == 8 || code == 1006) {
						addBitmap(1, langTip["WEB_unSupported"]);
					} else {
						//TODO:加载失败显示加载失败占位图
						addBitmap(0);
						showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					}

				})

			}

			function initEvent() {
				document.getElementById("settings_WDR").addEventListener('tap', function() {
					jumpToWebPage("settings_WDR", JSON.stringify(capabilityDataObj));
				});

				if(document.getElementById("settings_IntelligentLight")) {
					document.getElementById("settings_IntelligentLight").addEventListener('tap', function() {
						jumpToWebPage("settings_IntelligentLight", JSON.stringify(capabilityDataObj));
					});
				}
				if(document.getElementById("settings_DayNight")) {
					document.getElementById("settings_DayNight").addEventListener('tap', function() {
						jumpToWebPage("settings_DayNight", JSON.stringify(capabilityDataObj));
					});
				}

			}
		</script>
	</body>

</html>