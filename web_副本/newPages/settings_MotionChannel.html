<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
		<title></title>
		<link href="../css/mui.css" rel="stylesheet" />
		<link href="../css/iconfont.css" rel="stylesheet" />
		<link href="../css/Common.css" rel="stylesheet" />
		<link href="../css/theme_normal.css" rel="stylesheet" />
 	<style>
		.mui-table-view-cell .ui-tip {
			position: absolute;
			right: 0px;
			z-index: 100;
			width: 100% !important;
		}

		#SportCheck .mui-table-view-radio .mui-table-view-cell.mui-selected .mui-navigate-right:after {
			content: '\e442';
		}

		#SportCheck .mui-table-view-radio .mui-table-view-cell .mui-navigate-right:after {
			font-weight: 200;
		}

		.mode-style {
			font-size: 16px;
			color: #333;
			padding-left: 15px;
		}

		.mui-table-view-radio .mui-table-view-cell {
			height: 100%;
		}

		#SportCheck .mui-table-view-radio .mui-table-view-cell .mui-navigate-right:after {
			content: '\e411';
		}

		.mui-table-view-cell:last-child:before,
		.mui-table-view-cell:last-child:after {
			height: 1px;
		}

		.selectAudioStepli.mui-table-view-cell .mui-navigate-right>.mui-badge {
			width: 35% !important;
		}

		.captureTargetItem.mui-table-view-cell .mui-navigate-right>.mui-badge {
			width: 35% !important;
		}
      /* 灵敏度选项的样式 */
      .sensitivity-content {
				position: relative;
				height: 60px;
			}

			#Sensitivity-item .mui-radio,
      #Smart-Sensitivity-item .mui-radio {
				position: absolute;
				top: 0;
				height: 100%;
				width: 16px;
				z-index: 2;
			}

			#Sensitivity-item .radio-low,
      #Smart-Sensitivity-item .radio-low {
				left: 0;
			}

			#Sensitivity-item .radio-middle,
      #Smart-Sensitivity-item .radio-middle {
				left: 50%;
				margin-left: -8px;
			}

			#Sensitivity-item .radio-high,
      #Smart-Sensitivity-item .radio-high {
				left: 100%;
				margin-left: -16px;
			}
			
			#Sensitivity-item .radio-input,
      #Smart-Sensitivity-item .radio-input {
				position: absolute;
				top: 20px;
				left: 2px;
				width: 14px;
				height: 14px;
			}
			
			#Sensitivity-item .radio-input::before,
      #Smart-Sensitivity-item .radio-input::before {
				display: block;
				position: absolute;
				font-size: 16px;
				top: -1px;
				left: -2px;
			}

      #Sensitivity-item .radio-text-content,
      #Smart-Sensitivity-item .radio-text-content {
        position: absolute;
        top: 45px;
        width: 100%;
        height: 21px;
        z-index: 2;
      }

      #Sensitivity-item .radio-text-content .radio-text,
      #Smart-Sensitivity-item .radio-text-content .radio-text {
        width: 60px;
        font-size: 14px;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      #Sensitivity-item .radio-text-content .radio-text:nth-of-type(1),
      #Smart-Sensitivity-item .radio-text-content .radio-text:nth-of-type(1) {
        position: absolute;
        left: 0;
        text-align: left;
      }

      #Sensitivity-item .radio-text-content .radio-text:nth-of-type(2),
      #Smart-Sensitivity-item .radio-text-content .radio-text:nth-of-type(2) {
        position: absolute;
        left: 50%;
        margin-left: -30px;
        text-align: center;
      }

      #Sensitivity-item .radio-text-content .radio-text:nth-of-type(3),
      #Smart-Sensitivity-item .radio-text-content .radio-text:nth-of-type(3){
        position: absolute;
        right: 0;
        text-align: right;
      }
			
			#Sensitivity-item .line,
      #Smart-Sensitivity-item .line {
				position: absolute;
				width: 96%;
				height: 4px;
				top: 44%;
				left: 2%;
				margin-top: -1px;
				background-color: rgb(51,51,51,0.08);
				z-index: 1;
			}

      .mui-table-view .sensitivity-item {
        height: 126px;
      }

      .mui-table-view .sensitivity-item.mui-active {
        background-color: #fff;
      }

      .mui-table-view .sensitivity-title-content {
        height: 26px;
      }

      .mui-table-view .sensitivity-title {
        height: 26px;
      }
	</style>
</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a id="back" class="mui-icon iconfont icon-back1"></a>
			<h1 id="title" class="mui-title" data-text="WEB_motion_detection">&nbsp;</h1>
		</header>
		<div class="mui-content">
		<div id="EZView-content" class="mui-hidden">
			<!-- 运动检测 -->
			<ul id="SportCheck" class="mui-table-view ui-siwtchlist">
				<!-- 运动检测使能开关 -->
				<li id="SportCheckItem" class="mui-table-view-cell ">
					<span data-text="WEB_motion_detection" class="mainStyle">&nbsp;</span>
					<div id="SportCheckSwitch" class="mui-switch mui-switch-mini">
						<div class="mui-switch-handle" id="setMotionSwitch"></div>
					</div>
					<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
				</li>
				<!-- 普通模式/智能模式切换 -->
				<div id="motionMode" class="mui-table-view-radio mui-hidden">
					<li id="customMode" class="mui-table-view-cell mui-hidden" data-mode="0">
						<div class="mode-style mui-navigate-right" data-text="WEB_customMode">
							&nbsp;
						</div>
					</li>
					<li id="smartMode" class="mui-table-view-cell mui-hidden" data-mode="1">
						<div class="mode-style mui-navigate-right" data-text="WEB_smartMode">
							&nbsp;
						</div>
					</li>
				</div>
				<!-- 普通运动检测配置项 -->
				<div id="customModeConfig" class="mui-hidden">
					<!-- 区域绘制 -->
					<li id="CheckAreaItem" class="mui-table-view-cell mui-hidden">
						<a id="CheckArea" class="mui-navigate-right">&nbsp;
							<span data-text="WEB_Draw_Area" class="mainStyle padding-left-15">&nbsp;</span>
							<span class="mui-badge" style="display: none;"><img src="../images/draw@3x.png"
									alt="" /></span>
						</a>
						<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
					</li>
					<!-- 检测时间 -->
					<li id="CheckTimeItem" class="mui-table-view-cell mui-hidden">
						<a id="CheckTimeStep" class="mui-navigate-right">&nbsp;
							<span data-text="WEB_motion_detection_time_quantum"
								class="mainStyle padding-left-15">&nbsp;</span>
							<span id="CheckTimeStepVal" class="mui-badge"></span>
						</a>
					</li>
            
          <!-- 灵敏度配置 -->
          <li id="Sensitivity-item" class="mui-table-view-cell mui-hidden sensitivity-item">
            <!-- 灵敏度标题 -->
            <div class="sensitivity-title-content">
              <span data-text="WEB_Sensitivity" class="sensitivity-title-text padding-left-15">&nbsp;</span>
            </div>
            <!-- 灵敏度内容区 -->
            <div id="sensitivity-content" class="sensitivity-content" data-curValue="">
              <!-- 灵敏度 -  低 -->
              <div id="item-low" class="mui-input-row mui-radio mui-left radio-low">
                <input class="radio-input" name="radio1" type="radio" value="25">
              </div>
              <!-- 灵敏度 - 中 -->
              <div id="item-middle" class="mui-input-row mui-radio mui-left radio-middle">
                <input class="radio-input" name="radio1" type="radio" value="50">
              </div>
              <!-- 灵敏度 - 高 -->
              <div id="item-high" class="mui-input-row mui-radio mui-left radio-high">
                <input class="radio-input" name="radio1" type="radio" value="75">
              </div>
              <!-- 灵敏度档位文字 -->
              <div class="radio-text-content">
                <label class="radio-text" data-text="WEB_Low"></label>
                <label class="radio-text" data-text="WEB_Middle"></label>
                <label class="radio-text" data-text="WEB_High"></label>
              </div>
              <!-- 横线 -->
              <div class="line"></div>
            </div>
            <div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
          </li>

					<!-- 告警抓图 -->
					<li id="Snapshot" class="mui-table-view-cell ui-switch-item ui-invisible">
						<span data-text="WEB_alarm_snapshot" class="mainStyle padding-left-15">&nbsp;</span>
						<div id="SnapshotSwitch" class="mui-switch mui-switch-mini">
							<div class="mui-switch-handle"></div>
						</div>
						<div id="SnapshotText" class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
					</li>
				</div>
				<!-- 智能运动检测配置项 -->
				<div id="smartModeConfig" class="mui-hidden">
					<!-- 区域绘制 -->
					<li id="SmartMotionCheckAreaItem" class="mui-table-view-cell mui-hidden">
						<a id="SmartMotionCheckArea" class="mui-navigate-right">&nbsp;
							<span data-text="WEB_Draw_Area" class="mainStyle padding-left-15">&nbsp;</span>
							<span class="mui-badge" style="display: none;"><img src="../images/intrusion.png"
									alt="" /></span>
						</a>
						<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
					</li>
          
          <!-- 智能模式 - 灵敏度配置 -->
          <li id="Smart-Sensitivity-item" class="mui-table-view-cell mui-hidden sensitivity-item">
            <!-- 灵敏度标题 -->
            <div class="sensitivity-title-content">
              <span data-text="WEB_Sensitivity" class="sensitivity-title-text padding-left-15">&nbsp;</span>
            </div>
            <!-- 灵敏度内容区 -->
            <div id="smart-sensitivity-content" class="sensitivity-content" data-curValue="">
              <!-- 灵敏度 -  低 -->
              <div id="smart-item-low" class="mui-input-row mui-radio mui-left radio-low">
                <input class="radio-input" name="radio2" type="radio" value="25">
              </div>
              <!-- 灵敏度 - 中 -->
              <div id="smart-item-middle" class="mui-input-row mui-radio mui-left radio-middle">
                <input class="radio-input" name="radio2" type="radio" value="50">
              </div>
              <!-- 灵敏度 - 高 -->
              <div id="smart-item-high" class="mui-input-row mui-radio mui-left radio-high">
                <input class="radio-input" name="radio2" type="radio" value="75">
              </div>
              <!-- 灵敏度档位文字 -->
              <div class="radio-text-content">
                <label class="radio-text" data-text="WEB_Low"></label>
                <label class="radio-text" data-text="WEB_Middle"></label>
                <label class="radio-text" data-text="WEB_High"></label>
              </div>
              <!-- 横线 -->
              <div class="line"></div>
            </div>
            <div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
          </li>

					<!-- 抓拍目标 -->
					<li id="SmartMotionCaptureTargetItem" class="mui-table-view-cell mui-hidden captureTargetItem">
						<a href="#SmartMotionCaptureTarget" id="SmartMotionCaptureTargetStep"
							class="mui-navigate-right">&nbsp;
							<span data-text="WEB_snapshotObject" class="mainStyle padding-left-15">&nbsp;</span>
							<span id="IntrusionDetectionCaptureTargetItemStepVal" class="mui-badge">&nbsp;</span>
						</a>
						<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
					</li>
					<!-- 声音报警 -->
					<li id="AudioAlarmTtem" class="mui-table-view-cell  mui-hidden">
						<!-- 声音报警开关 -->
						<a id="AudioAlarmStep">&nbsp;
							<span data-text="WEB_audio_alarm" class="mainStyle padding-left-15">&nbsp;</span>
							<div id="setAudioAlarmSwitch" class="mui-switch mui-switch-mini">
								<div class="mui-switch-handle" id="setAudioAlarmCircle"></div>
							</div>
						</a>
						<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
					</li>
					<div id="alarmModal">
						<!-- 声音报警联动模式 -->
						<li id="AudioAlarmModeItem" class="mui-table-view-cell mui-hidden">
							<a id="AudioAlarmModeStep" class="mui-navigate-right">&nbsp;
								<span data-text="WEB_linkageMode" class="mainStyle padding-left-30">&nbsp;</span>
								<span id="AudioAlarmModeStepVal" class="mui-badge"></span>
							</a>
							<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
						</li>
						<!-- 报警音选择 -->
						<li id="selectAudioItem" class="mui-table-view-cell selectAudioStepli mui-hidden">
							<a id="selectAudioStep" class="mui-navigate-right">&nbsp;
								<span data-text="WEB_alarm_audio_selected"
									class="mainStyle padding-left-30">&nbsp;</span>
								<span id="selectAudioStepVal" class="mui-badge"></span>
							</a>
							<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
						</li>
					</div>
					<!-- 灯光报警 -->
					<li id="LightAlarmTtem" class="mui-table-view-cell  mui-hidden">
						<a id="LightAlarmStep">&nbsp;
							<span data-text="WEB_light_alarm" class="mainStyle padding-left-15">&nbsp;</span>
							<div id="setLightAlarmSwitch" class="mui-switch mui-switch-mini">
								<div class="mui-switch-handle" id="setLightAlarmCircle"></div>
							</div>
						</a>
						<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
					</li>
					<!-- 灯光报警联动模式 -->
					<div id="alarmLightModal">
						<li id="LightAlarmModeItem" class="mui-table-view-cell mui-hidden">
							<a id="LightAlarmModeStep" class="mui-navigate-right">&nbsp;
								<span data-text="WEB_linkageMode" class="mainStyle padding-left-30">&nbsp;</span>
								<span id="LightAlarmModeStepVal" class="mui-badge"></span>
							</a>
							<div class="loadFailed mui-hidden" data-text="WEB_loadFailed">&nbsp;</div>
						</li>
					</div>
				</div>
			</ul>
		</div>
	</div>
	<!-- 智能运动检测抓拍目标弹框 -->
	<div id="SmartMotionCaptureTarget"
		class="mui-popover mui-popover-action mui-popover-bottom ui-radio-list no-title-popover">
		<form id="CaptureTargetList" class="mui-input-group">
			<div class="mui-input-row mui-checkbox mui-hidden">
				<label data-text="WEB_motorVehicle">&nbsp;</label>
				<input name="n1" class="checked" value=0 type="checkbox">
			</div>
			<div class="mui-input-row mui-checkbox mui-hidden">
				<label data-text="WEB_nonMotorVehicle">&nbsp;</label>
				<input name="n2" class="checked" value=1 type="checkbox">
			</div>
			<div class="mui-input-row mui-checkbox mui-hidden">
				<label data-text="WEB_pedestrian">&nbsp;</label>
				<input name="n3" class="checked" value=2 type="checkbox">
			</div>
		</form>
		<button id="SmartMotionCaptureTargetOk" class="mui-btn mui-btn-block ui-dateok"
			data-text="WEB_button_ok">&nbsp;</button>
	</div>
	<!-- 智能运动检测选择报警音弹窗 -->
	<div id="selectAudio" class="mui-popover mui-popover-action mui-popover-bottom ui-radio-list">
		<form class="mui-input-group">
			<div class="mui-input-row mui-checkbox ui-list-titile">
				<label data-text="WEB_alarm_audio_selected">&nbsp;</label>
				<span id="closeAudioList" class="mui-icon mui-icon-closeempty"></span>
			</div>
			<div id="selectAudioListItem" class="ui-list-container">
				<div class="mui-scroll-wrapper">
					<div class="mui-scroll">
						<ul id="selectAudioList" class="mui-table-view mui-table-view-radio">
						</ul>
					</div>
				</div>
			</div>
		</form>
		<button id="selectAudioListOk" class="mui-btn mui-btn-block ui-dateok" data-text="WEB_button_ok">&nbsp;</button>
	</div>
		<script src="../js/dsbridge.min.js"></script>
		<script src="../js/common.js"></script>
		<script src="../js/libs/md5.js"></script>
		<script src="../js/libs/jquery-3.4.1.min.js"></script>
		<script src="../js/libs/sha2.js"></script>
		<script src="../js/resource.js"></script>
		<script src="../js/Utils.js"></script>
		<script src="../js/mui.js"></script>
		<script src="../js/immersed.js"></script>
		<script src="../js/customSetting.js"></script>
		<script src="../js/loadCss.js"></script>
    <script id="langScript"></script>
		<script>
			var langTip;
			var GridService; //DetectionAreas接口服务器端数据
			var SportCheckConfirm = true; //运动检测状态变化时是否调接口提交
			var SnapshotConfirm = true; //告警抓图开关状态变化时是否调接口提交
			var sportcheck; //运动检测开关是否开启
			var SnapshotOpen; //告警抓图开关是否开启
			var SensitivityVal; //灵敏度取值
			var SensitivityChecked = ''; //灵敏度列表选中项
			var SnapshotService; //SchedulePicture 接口服务器端数据，告警抓图
			var LinkActionsService; //LinkageActions 接口服务器端数据，告警抓图
			var CheckTimeServiceData; //检测时间服务端数据
			var CheckTimeStepChecked = ''; //检测时间初始值“全天”“自定义”
		var ModeRuleData;
		var SmartMotionGridService;
		var SmartMotionSensitivityVal; //灵敏度取值
		var SmartCapabilitiesData; //智能能力数据
		var SmartMotionSensitivityChecked; //灵敏度列表选中项
		var CTargetList; //选中目标
		var SmartMotionTargetCheckList; //目标列表选中项
		var DetectTargetInfo = {
			Enabled: 0,
			Type: "",
			ObjectMaxSize: {
				Width: 9999,
				Height: 9999
			},
			ObjectMinSize: {
				Width: 105,
				Height: 186
			}
		};
		var timeCustom;
		var AudioTimeSectionInfo = {
			Enabled: 0,
			Begin: "00:00:00",
			End: "00:00:00",
			AudioActParamInfo: {
				AudioFileID: 0,
				WarnCount: 3,
				AudioVolume: 255
			}
		};
		var LightTimeSectionInfo = {
			Enabled: 0,
			Begin: "00:00:00",
			End: "00:00:00"
		};
		var Day = {
			ID: -1,
			Num: 0,
			TimeSectionInfos: []
		};
		var configData = {
			Num: 2,
			Actions: [{
				Enabled: 1,
				ActID: 28,
				ActParam: {
					TimeMode: 0,
					AudioCustomInfo: {
						Num: 7,
						Days: []
					},
					AudioDayNightInfo: {
						Num: 7,
						Days: []
					}
				}
			}, {
				Enabled: 1,
				ActID: 29,
				ActParam: {
					TimeMode: 1,
					LightCustomInfo: {
						LightActParamInfo: {
							Interval: 10,
							Luminance: 50
						},
						LightWeekPlanInfo: {
							Num: 7,
							Days: []
						}
					},
					LightDayNightInfo: {
						LightActParamInfo: {
							Interval: 10,
							Luminance: 50
						},
						LightDayNightPlanInfo: {
							Num: 7,
							Days: []
						}
					}
				}
			}]
		};
		var audioDayNight = {
			AudioDayInfo: {
				AudioActParamInfo: {
					AudioFileID: 0,
					WarnCount: 3,
					AudioVolume: 255
				},
				Enabled: 0
			},
			AudioNightInfo: {
				AudioActParamInfo: {
					AudioFileID: 0,
					WarnCount: 3,
					AudioVolume: 255
				},
				Enabled: 0
			},
			ID: -1
		};
		var lightDayNight = {
			LightDayInfo: {
				Enabled: 0
			},
			LightNightInfo: {
				Enabled: 0
			},
			ID: -1
		};
		var saveData;
		var devOrgData;
		var devAudioInfo;
		var devLightInfo;
		var SupportLinkageDayNightMode = 0; //支持日夜模式
		var audioName;
		var setAudioAlarmConfirm = true; //声音开关状态变化时是否调接口提交
		var setLightAlarmConfirm = true; //灯光开关状态变化时是否调接口提交
		var AlarmLAPI;
		var AudioFile;
		var AudioAlarmCheck; // 声音开关是否开启
		var LightAlarmCheck; // 灯光开关是否开启
		var AudioCustomCheckedarr = []; //报警音选择列表名称
		var AudioDayNightCheckedarr = []; //日夜模式报警音选择列表名称
		var saveOrg;
		var supportAudioAlarm = true;
		var supportLightAlarm = true;
		var supportTarget = true;
		var AlarmAudioList;
		var deviceData;
		var dismissFlag; // 不支持smd告警抓图开关显示延迟问题标志位
			checkType(localStorage.AppType); //加载特定样式
			mui.init();
			var typeLan = initLang();
			langTip = typeLan.lang;
		initPage();
		// initData();
		// initEvent();

		function initPage() {
			initSmartMotion();
		}
			function initData() {
			$("#customModeConfig").removeClass("mui-hidden");
				initSportCheckSwitch(); //发请求获取运动检测使能、区域绘制及灵敏度数据初始化
			}

			function initEvent() {
				document.getElementById("SportCheckSwitch").addEventListener("toggle", function(event) {
					SportCheckSwitch(event); //监听运动检测 开关
				});
				customEvent();
				document.getElementById('CheckArea').addEventListener('tap', CheckArea); //区域绘制点击事件
        // 普通模式 - 灵敏度单选框 change 事件
        $('#sensitivity-content input[name="radio1"]').each(function (index, el) {
          el.addEventListener('change', handlerChangeRadio)
        })

        // 灵敏度单选框 change 事件处理函数
        function handlerChangeRadio() {
          // 本次 change 之前被选中的值
          var curCheckedRadioValue = $('#sensitivity-content').attr('data-curValue');
          // 本次 change 之后的目标值
          var curChangeRadioValue = $(this).val();

          var sendData = deepCopy(GridService);
          sendData.Sensitivity = Number(curChangeRadioValue);
          dsBridgeFuncSyn.showLoading();
          SendAjax(LAPI.DetectionAreas, 'put', function (code, data) {
            dsBridgeFuncSyn.dismiss();
            if (code == 0) {
              GridService = deepCopy(sendData);
              // 将当前选中的值存储到 data-curValue 属性中
              $('#sensitivity-content').attr('data-curValue', curChangeRadioValue);
              showToast(langTip["WEB_android_35"]);
            } else {
              // 接口请求失败，将单选框的选中状态还原
              $('#sensitivity-content input[name="radio1"]').each(function (index, El) {
                if (El.value == curCheckedRadioValue) {
                  El.checked = true;
                } else {
                  El.checked = false;
                }
              })
              showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
            }
          }, sendData);
        }
				document.getElementById('CheckTimeStep').addEventListener('tap', CheckTimeStep); //检测时段点击事件
				document.getElementById("SnapshotSwitch").addEventListener("toggle", function(event) {
					SnapshotSwitch(event); //监听告警抓图 开关
				});
			}

		/*
		 * 初始化 智能运动检测能力
		 */
		function initSmartMotion() {
			SendAjax(LAPI.SmartCapabilities, 'get', function (code, data) {
				if (code == 0) {
					if (data.SmartMotionDetection && data.SmartMotionDetection.SupportCfg && data.SmartMotionDetection.SupportCfg == 1) {
						// 获取当前设备信息
						deviceData = data;
						if (!(data.SmartMotionDetection.SupportDetectObjectList && data.SmartMotionDetection.SupportDetectObjectList.length > 0)) {
							$("#SmartMotionCaptureTargetItem").remove();
						}
						if (!(data.SmartMotionDetection.LinkagePlanCfg && (data.SmartMotionDetection.LinkagePlanCfg.SupportAudioLinkagePlan == 1))) {
							$("#AudioAlarmTtem").remove();
							$("#alarmModal").remove();
							supportAudioAlarm = false;
						}
						if (!(data.SmartMotionDetection.LinkagePlanCfg && (data.SmartMotionDetection.LinkagePlanCfg.SupportLightLinkagePlan == 1))) {
							$("#LightAlarmTtem").remove();
							$("#alarmLightModal").remove();
							supportLightAlarm = false;
						}
						SmartCapabilitiesData = JSON.parse(JSON.stringify(data.SmartMotionDetection));
						initMotionMode();
						dismissFlag = false;
					} else {
						initData();
						initEvent();
						dismissFlag = true;
					}
				} else if (code == 4 || code == 8 || code == 1006) {
					initData();
					initEvent();
					dismissFlag = true;
				} else {
					//数据获取失败的处理
					addBitmap(0);
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					dsBridgeFuncSyn.dismiss();
				}
			});
		}

		function customEvent() {
			/*区域绘制点击事件*/
			document.getElementById('CheckArea').addEventListener('tap', CheckArea);
			/*运动检测时段*/
			document.getElementById('CheckTimeStep').addEventListener('tap', CheckTimeStep);
		}

		function initNewEvent() {
			/*监听运动检测开关*/
			document.getElementById("SportCheckSwitch").addEventListener("toggle", function (event) {
				NewSportCheckSwitch(event);
			});
			//监听告警抓图 开关
			document.getElementById("SnapshotSwitch").addEventListener("toggle", function (event) {
				SnapshotSwitch(event);
			});

      // 普通模式 - 灵敏度单选框 change 事件
      $('#sensitivity-content input[name="radio1"]').each(function (index, el) {
        el.addEventListener('change', handlerChangeRadio)
      })

      // 灵敏度单选框 change 事件处理函数
      function handlerChangeRadio() {
        // 本次 change 之前被选中的值
        var curCheckedRadioValue = $('#sensitivity-content').attr('data-curValue');
        // 本次 change 之后的目标值
        var curChangeRadioValue = $(this).val();

        var sendData = deepCopy(GridService);
        sendData.Sensitivity = Number(curChangeRadioValue);
        dsBridgeFuncSyn.showLoading();
        SendAjax(LAPI.DetectionAreas, 'put', function (code, data) {
          dsBridgeFuncSyn.dismiss();
          if (code == 0) {
            GridService = deepCopy(sendData);
            // 将当前选中的值存储到 data-curValue 属性中
            $('#sensitivity-content').attr('data-curValue', curChangeRadioValue);
            showToast(langTip["WEB_android_35"]);
          } else {
            // 接口请求失败，将单选框的选中状态还原
            $('#sensitivity-content input[name="radio1"]').each(function (index, El) {
              if (El.value == curCheckedRadioValue) {
                El.checked = true;
              } else {
                El.checked = false;
              }
            })
            showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
          }
        }, sendData);
      }
      
      // 智能模式 - 灵敏度单选框
      $('#smart-sensitivity-content input[name="radio2"]').each(function (index, el) {
        el.addEventListener('change', handlerChangeSmartRadio)
      })
      // 智能模式 - 灵敏度单选框 change 事件处理函数
      function handlerChangeSmartRadio() {
        // 本次 change 之前被选中的值
        var curCheckedRadioValue = $('#smart-sensitivity-content').attr('data-curValue');
        // 本次 change 之后的目标值
        var curChangeRadioValue = $(this).val();

        var sendData = deepCopy(SmartMotionGridService);
        sendData.RECTAreas[0].Sensitivity = Number(curChangeRadioValue);

        dsBridgeFuncSyn.showLoading();
        SendAjax(LAPI.SmartMotionDetectionAreas, 'put', function (code, data) {
          dsBridgeFuncSyn.dismiss();
          if (code == 0) {
            SmartMotionGridService = deepCopy(sendData);
            // 将当前选中的值存储到 data-curValue 属性中
            $('#smart-sensitivity-content').attr('data-curValue', curChangeRadioValue);
            showToast(langTip["WEB_android_35"]);
          } else {
            // 接口请求失败，将单选框的选中状态还原
            $('#smart-sensitivity-content input[name="radio2"]').each(function (index, El) {
              if (El.value == curCheckedRadioValue) {
                El.checked = true;
              } else {
                El.checked = false;
              }
            })
            showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
          }
        }, sendData);
      }
			/*运动检测  区域绘制*/
			document.getElementById('SmartMotionCheckArea').addEventListener('tap', SmartMotionCheckArea);
			/*运动检测  报警联动*/
			//选中目标
			document.getElementById('SmartMotionCaptureTargetOk').addEventListener('tap', SmartMotionCaptureTargetOk);
			var list = document.querySelector('#motionMode');
			list.addEventListener('selected', function (e) {
				var sendData = deepCopy(ModeRuleData);
				sendData.Mode = Number(e.detail.el.getAttribute("data-mode"));
				dsBridgeFuncSyn.showLoading();
				SendAjax(LAPI.NewMotionDetectionRule, 'put', function (code, data) {
					dsBridgeFuncSyn.dismiss();
					if (code == 0) {
						ModeRuleData = deepCopy(sendData);
						stwichStatusChange(ModeRuleData.Enabled);
						showToast(langTip["WEB_api_error_succeeded"]);
					} else {
						setMotionMode(ModeRuleData.Mode);
						showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
					}
				}, sendData);
			});
			document.getElementById('closeAudioList').addEventListener('tap', function () {
				mui('#selectAudio').popover('toggle');
			});

			if (supportTarget) {
				document.getElementById('SmartMotionCaptureTargetItem').addEventListener('tap', function () {
					mui('#CaptureTargetList input').each(function (index, El) {
						El.checked = false;
					});
					for (var i = 0; i < CTargetList.length; i++) {
						mui('#CaptureTargetList input').each(function (index, El) {
							if (CTargetList[i].Enabled == 1 && CTargetList[i].Type == Number(El.value)) {
								El.checked = true;
								return;
							}
						});
					}
					setTarget();
				});
			}
			document.getElementById('selectAudioListOk').addEventListener('tap', selectAudioListOk); //报警音确定
			document.querySelectorAll(".selectAudioStepli a").forEach(function (v) { // 报警音弹框选择
				v.addEventListener('tap', function (event) {
					var textAudio = $("#selectAudioStepVal").text().trim();
					audioCurNode = $(v);
					mui('#selectAudio').popover('toggle');

					mui('#selectAudioList a').each(function (index, El) {
						El.parentNode.classList.remove('mui-selected');
						if (El.innerText.trim() == textAudio) {
							El.parentNode.classList.add('mui-selected');
						}
					});
				})
			});

			if (supportAudioAlarm) {
				document.getElementById("AudioAlarmModeItem").addEventListener("tap", function () {
					var Extras = {
						AlarmType: 1,
						SupportLinkageDayNightMode: SupportLinkageDayNightMode,
						saveData: saveData,
						devOrgData: devOrgData,
						configData: configData,
						AlarmLAPI: AlarmLAPI,
						ActID: 0,
						supportAudioAlarm: supportAudioAlarm,
						supportLightAlarm: supportLightAlarm
					}
					jumpToWebPage("settings_DeepAlarmRe", JSON.stringify(Extras));
				});
				initAudioAlarmSwtich();
			}
			if (supportLightAlarm) {
				document.getElementById("LightAlarmModeItem").addEventListener("tap", function () {
					var Extras = {
						AlarmType: 1,
						SupportLinkageDayNightMode: SupportLinkageDayNightMode,
						saveData: saveData,
						devOrgData: devOrgData,
						configData: configData,
						AlarmLAPI: AlarmLAPI,
						ActID: 1,
						supportAudioAlarm: supportAudioAlarm,
						supportLightAlarm: supportLightAlarm
					}
					jumpToWebPage("settings_DeepAlarmRe", JSON.stringify(Extras));
				});
				initLightAlarmSwtich();
			}

			customEvent();
		}

		/**
		 * 监听运动检测开关
		 * @param {Object} event
		 */
			function SportCheckSwitch(event) {
				if(event.detail.isActive && SportCheckConfirm) {
					var sendDataON = deepCopy(GridService);
					sendDataON.Enabled = 1;
					GridService.Enabled = 1;
					dsBridgeFuncSyn.showLoading();
					SendAjax(LAPI.DetectionAreas, 'put', function(code, data) {
						dsBridgeFuncSyn.dismiss();
						if(code == 0) {
							mui("#SportCheck .mui-table-view-cell").each(function(index, El) {
								if(index != 0) {
									El.classList.remove('mui-hidden');
									El.classList.remove('ui-invisible');
								}
							});
						} else {
							showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
							SportCheckConfirm = false;
							setTimeout(function() {
								mui("#SportCheckSwitch").switch().toggle();
							}, 200);

						}
					}, sendDataON);

				} else if(!event.detail.isActive && SportCheckConfirm) {
					mui("#SportCheck .mui-table-view-cell").each(function(index, El) {
						if(index != 0) {
							El.classList.add('mui-hidden');
							El.classList.add('ui-invisible');
						}
					});
					var sendDataOFF = deepCopy(GridService);
					sendDataOFF.Enabled = 0;
					GridService.Enabled = 0;
					dsBridgeFuncSyn.showLoading();
					SendAjax(LAPI.DetectionAreas, 'put', function(code, data) {
						dsBridgeFuncSyn.dismiss();
						if(code == 0) {

						} else {
							showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
							SportCheckConfirm = false;
							setTimeout(function() {
								mui("#SportCheckSwitch").switch().toggle();
								mui("#SportCheck .mui-table-view-cell").each(function(index, El) {
									if(index != 0) {
										El.classList.remove('mui-hidden');
									}
								});
							}, 200);
						}
					}, sendDataOFF);
				} else {
					SportCheckConfirm = true;
				};
			}

		/*
		 * 初始化运动检测模式和使能
		 */
		function initMotionMode() {
			SendAjax(LAPI.NewMotionDetectionRule, 'get', function (code, data) {
				if (code == 0) {
					ModeRuleData = JSON.parse(JSON.stringify(data));
					sportcheck = data.Enabled;
					stwichStatusChange(sportcheck);
					initMotionDetectionRule();
					//显示运动检测配置选项
					$("#customMode").removeClass("mui-hidden");
					$("#smartMode").removeClass("mui-hidden");
					//隐藏联动模式/自定义报警
					$("#alarmModal").addClass("mui-hidden");
					$("#alarmLightModal").addClass("mui-hidden");
					mui("#SportCheck .mui-table-view-cell").each(function (index, El) {
						if (index != 0) {
							El.classList.remove('mui-hidden');
							// 仅开关开启时显示告警抓图配置项
							if (sportcheck == 1) {
								El.classList.remove('ui-invisible');
							}
						}
					});
					setMotionMode(data.Mode);
					//初始化运动检测模式
					initSmartMotionData();
				} else {
					//数据获取失败的处理
					addBitmap(0);
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					dsBridgeFuncSyn.dismiss();
				}
			});
		}

		/*
		 * 初始化运动检测检测区域、灵敏度、抓怕目标
		 */
		function initSmartMotionData() {
			SendAjax(LAPI.SmartMotionDetectionAreas, 'get', function (code, data) {
				if (code == 0) {
					document.getElementById("SmartMotionCheckArea").classList.add("mui-navigate-right");
					document.getElementById("SmartMotionCheckArea").children[1].style.display = "block";
					SmartMotionGridService = JSON.parse(JSON.stringify(data));

          // 接口获取到的灵敏度数值
					SmartMotionSensitivityVal = data.RECTAreas[0].Sensitivity;
          // 将接口中的灵敏度数值，转化为三个档位
          var gearSmartMotionSensitivityVal = SensitivityValue(SmartMotionSensitivityVal);
          // 根据接口中的灵敏度数值，初始化界面显示
          $('#smart-sensitivity-content input[name="radio2"]').each(function (index, el) {
            if (el.value == gearSmartMotionSensitivityVal) {
              el.checked = true;
            }
          });
          // 在单选框的父元素上，添加 data-value 属性，用于记录当前选中的灵敏度
          $('#smart-sensitivity-content').attr('data-curValue', gearSmartMotionSensitivityVal)

					initSmartMotionCaptureTargetList();
					if (data.RECTAreas[0].DetectTargetList) {
						if (data.RECTAreas[0].Num > 0) {
							CTargetList = data.RECTAreas[0].DetectTargetList;
							for (var i = 0; i < CTargetList.length; i++) {
								mui('#CaptureTargetList input').each(function (index, El) {
									if (CTargetList[i].Enabled == 1 && CTargetList[i].Type == El.value) {
										El.checked = true;
									}
								});
							}
							// 界面显示已勾选抓拍目标内容
							setTarget();
						}
					}
					//初始化告警抓图
					initSnapshot();
					if (supportAudioAlarm || supportLightAlarm) {
						getDaycap();
					} else {
						dsBridgeFuncSyn.dismiss();
					}
					initNewEvent();
					initOldCheckTime();
				} else {
					//数据获取失败的处理
					addBitmap(0);
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					dsBridgeFuncSyn.dismiss();
				}
			});
		}

		function initSmartMotionCaptureTargetList() {
			mui("#CaptureTargetList input").each(function (index, El) {
				console.log(El);
				if (SmartCapabilitiesData.SupportDetectObjectList && SmartCapabilitiesData.SupportDetectObjectList.length > 0) {
					for (var i = 0; i < SmartCapabilitiesData.SupportDetectObjectList.length; i++) {
						console.log(Number(El.value));
						if (i == Number(El.value) && SmartCapabilitiesData.SupportDetectObjectList[i] == 1) {
							console.log(El.parentElement);
							$(El.parentElement).removeClass("mui-hidden");
							break;
						}
					}
				}
			});
		}

		function setMotionMode(mode) {
			mui("#motionMode li").each(function () {
				if (Number(this.getAttribute("data-mode")) == mode) {
					$(this).addClass("mui-selected");
				} else {
					$(this).removeClass("mui-selected");
				}
			});
		}

		/*
		 * 初始化运动检测样式
		 */
		function initMotionDetectionRule() {
			//初始化运动检测开关
			document.getElementById("SportCheckSwitch").style.zIndex = 20;
			document.getElementById("SportCheckSwitch").style.visibility = "visible";
			SportCheckConfirm = false;
			setSwitchStatus("SportCheckSwitch", sportcheck);
			SportCheckConfirm = true;
			var setMotionActive = document.getElementById("SportCheckSwitch").classList.contains("mui-active");
			if (setMotionActive) {
				document.getElementById("setMotionSwitch").style.transform = 'translate(16px, 0px)';
			}
		}
			function CheckTimeStep() {
				var checkDate = this.children[1].innerText.trim();
				var Extras = {
					isCapality: 2,
					checkDate: checkDate,
					ServiceData: CheckTimeServiceData
				}
				jumpToWebPage("settings_CheckTime", JSON.stringify(Extras));
			}

		/**
		 * 监听告警抓图开关
		 * @param {Object} event
		 */
			function SnapshotSwitch(event) {
				var isEnable = event.detail.isActive;
				var sendLinkActions = deepCopy(LinkActionsService);
				var sendSnapshot = deepCopy(SnapshotService);
				if(SnapshotConfirm) {
					var weekPlanMap = {
						"Num": 7,
						"Days": []
					};
					for(var num = 1; num < 8; num++) {
						var dayPlanInfo = {
							"ID": 1,
							"Num": 1,
							"TimeSectionInfos": []
						};
						var timeSectinInfo = {};
						if(isEnable) {
							timeSectinInfo.Begin = "00:00:00";
							timeSectinInfo.End = "24:00:00";
						} else {
							timeSectinInfo.Begin = "00:00:00";
							timeSectinInfo.End = "00:00:00";
						}
						timeSectinInfo.ArmingType = 1;
						dayPlanInfo.ID = num;
						dayPlanInfo.TimeSectionInfos.push(timeSectinInfo);
						weekPlanMap.Days.push(dayPlanInfo);
					}
					for(var numl = 0; numl < sendLinkActions.Num; numl++) {
						if(sendLinkActions.Actions[numl].ActID == 6) {
							if(isEnable) {
								sendLinkActions.Actions[numl].ActParam.Num = 1;
								sendLinkActions.Actions[numl].ActParam.IDs = [Number(localStorage.channelId)];
								sendSnapshot.Enabled = 1;
								sendSnapshot.WeekPlan = weekPlanMap;
							} else {
								sendLinkActions.Actions[numl].ActParam.Num = 0;
								sendLinkActions.Actions[numl].ActParam.IDs = [];
								sendSnapshot.Enabled = 0;
								sendSnapshot.WeekPlan = weekPlanMap;
							}
						}
					}

					dsBridgeFuncSyn.showLoading();
					SendAjax(LAPI.SchedulePicture, 'put', function(code, data) {
						if(code == 0) {
							SendAjax(LAPI.LinkageActions, 'put', function(code, data) {
								dsBridgeFuncSyn.dismiss();
								if(code == 0) {

								} else {
									showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
									SnapshotConfirm = false;
									setTimeout(function() {
										mui("#SnapshotSwitch").switch().toggle();
									}, 300);
								}
							}, sendLinkActions);
						} else {
							dsBridgeFuncSyn.dismiss();
							showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
							SnapshotConfirm = false;
							setTimeout(function() {
								mui("#SnapshotSwitch").switch().toggle();
							}, 200);
						}
					}, sendSnapshot);
				} else {
					SnapshotConfirm = true;
				}
			}

			/*
			 * 发请求获取运动检测使能、区域绘制及灵敏度数据初始化
			 */
			function initSportCheckSwitch() {
				SendAjax(LAPI.DetectionAreas, 'get', function(code, data) {
					if(code == 0) {
					$("#EZView-content").removeClass("mui-hidden");
						GridService = deepCopy(data);

            // 接口获取到的灵敏度 数值
						SensitivityVal = data.Sensitivity;
            // 将接口中的灵敏度数值，转换为三个档位
            var gearSensitivityVal = SensitivityValue(SensitivityVal);
            // 根据接口中的灵敏度数值，初始化界面显示
            $('#sensitivity-content input[name="radio1"]').each(function (index, el) {
              if (el.value == gearSensitivityVal) {
                el.checked = true;
              }
            });
            // 在单选框的父元素上，添加 data-value 属性，用于记录当前选中的灵敏度
            $('#sensitivity-content').attr('data-curValue', gearSensitivityVal)

						sportcheck = data.Enabled;
						//初始化运动检测开关
						document.getElementById("SportCheckSwitch").style.zIndex = 20;
						document.getElementById("SportCheckSwitch").style.visibility = "visible";
						SportCheckConfirm = false;
						setSwitchStatus("SportCheckSwitch", sportcheck);
						SportCheckConfirm = true;
					// 初始化区域绘制图标
					document.getElementById("CheckArea").classList.add("mui-navigate-right");
					document.getElementById("CheckArea").children[1].style.display = "block"
						//若运动检测开启则显示配置选项并初始化
						if(sportcheck == 1) {
							//显示运动检测配置选项
							mui("#SportCheck .mui-table-view-cell").each(function(index, El) {
								if(index != 0) {
									El.classList.remove('mui-hidden');
									El.classList.remove('ui-invisible');
								}
							});
						}
						//检测时间初始化
						initWeekPlan();
						//初始化告警抓图
						initSnapshot();
					} else {
						//数据获取失败的处理
						addBitmap(0);
						showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
						dsBridgeFuncSyn.dismiss();
					}
				});
			}

			/*
			 * 发请求获取告警抓图初始化
			 */
			function initSnapshot() {
				var ActionOK = false;
				SendAjax(LAPI.LinkageActions, 'get', function(code, data) {
					if(code == 0) {
						LinkActionsService = deepCopy(data);
						for(var numl = 0; numl < LinkActionsService.Num; numl++) {
							if(LinkActionsService.Actions[numl].ActID == 6) {
								if(LinkActionsService.Actions[numl].ActParam.Num != 0) {
									for(var j = 0; j < LinkActionsService.Actions[numl].ActParam.Num; j++) {
										if(LinkActionsService.Actions[numl].ActParam.IDs[j] == localStorage.channelId) {
											ActionOK = true;
										}
									}
								}
							}
						}
						SendAjax(LAPI.SchedulePicture, 'get', function(code, data) {
							if(code == 0) {
								SnapshotService = deepCopy(data);
								//初始化告警抓图开关
								document.getElementById("SnapshotSwitch").style.zIndex = 20;
								document.getElementById("SnapshotSwitch").style.visibility = "visible";
								if(data.Enabled == 1 && ActionOK) {
									SnapshotOpen = 1;
								} else {
									SnapshotOpen = 0;
								}
								SnapshotConfirm = false;
								setSwitchStatus("SnapshotSwitch", SnapshotOpen);
								setTimeout(function() {
									SnapshotConfirm = true;
								}, 200);
							if (dismissFlag == true) {
								dsBridgeFuncSyn.dismiss();
							}
							} else {
								//数据获取失败的处理
								$("#Snapshot div.loadFailed").removeClass("mui-hidden");
								dsBridgeFuncSyn.dismiss();
							}
						});
					} else {
						//数据获取失败的处理
						$("#Snapshot div.loadFailed").removeClass("mui-hidden");
						dsBridgeFuncSyn.dismiss();
					}
				});
			}

		/*
			* 发请求获取检测时间初始化
			*/
		function initWeekPlan() {
			//获取检测时间并初始化
			SendAjax(LAPI.DetectionWeekPlan, 'get', function (code, data) {
				if (code == 0) {
					CheckTimeServiceData = deepCopy(data);
					var timeObj = getTimeType(data);
					timeCustom = timeObj.timeCustom;
					//初始化检测时间
					CheckTimeStepChecked = initCheckTime(data);
					document.getElementById('CheckTimeStepVal').innerText = CheckTimeStepChecked;
				} else {
					//数据获取失败的处理
					$("#SportCheck div.loadFailed").removeClass("mui-hidden");
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
				}
				dsBridgeFuncSyn.dismiss();
			});
		}

		function initOldCheckTime() {
			SendAjax(LAPI.DetectionWeekPlan, 'get', function (code, data) {
				if (code == 0) {
					CheckTimeServiceData = deepCopy(data);
					//初始化区域绘制数据
					initAreas();
				} else {
					//数据获取失败的处理
					addBitmap(0);
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					dsBridgeFuncSyn.dismiss();
				}
			});
		}
		/**
		 * 下发 运动检测 使能
		 * @param {Object} event
		 */
		function NewSportCheckSwitch() {
			if (event.detail.isActive && SportCheckConfirm) {
				var sendDataON = deepCopy(ModeRuleData);
				sendDataON.Enabled = 1;
				dsBridgeFuncSyn.showLoading();
				SendAjax(LAPI.NewMotionDetectionRule, 'put', function (code, data) {
					dsBridgeFuncSyn.dismiss();
					if (code == 0) {
						stwichStatusChange(1);
						// 点击开启运动检测开关时，显示告警抓图配置项
						$("#Snapshot").removeClass("ui-invisible");
						ModeRuleData.Enabled = 1;
						showToast(langTip["WEB_api_error_succeeded"]);
					} else {
						SportCheckConfirm = false;
						showToast(langTip["WEB_api_error_operation_fails"] + "(" + code + ")", code);
						setTimeout(function () {
							mui("#SportCheckSwitch").switch().toggle();
						}, 200);
					}
				}, sendDataON);
			} else if (!event.detail.isActive && SportCheckConfirm) {
				stwichStatusChange(0);
				// 点击关闭运动检测开关时，隐藏告警抓图配置项
				$("#Snapshot").addClass("ui-invisible");
				var sendDataOFF = deepCopy(ModeRuleData);
				sendDataOFF.Enabled = 0;
				dsBridgeFuncSyn.showLoading();
				SendAjax(LAPI.NewMotionDetectionRule, 'put', function (code, data) {
					dsBridgeFuncSyn.dismiss();
					if (code == 0) {
						showToast(langTip["WEB_api_error_succeeded"]);
						ModeRuleData.Enabled = 0;
					} else {
						SportCheckConfirm = false;
						showToast(langTip["WEB_api_error_operation_fails"] + "(" + code + ")", code);
						setTimeout(function () {
							mui("#SportCheckSwitch").switch().toggle();
							stwichStatusChange(1);
						}, 300);
					}
				}, sendDataOFF);
			} else {
				SportCheckConfirm = true;
			}
		}

		/**
		 * 跳转至检测时间页面
		 */
		function CheckTimeStep() {
			var checkDate = this.children[1].innerText.trim();
			// TODO:页面跳转+传参
			var Extras = {
				isCapality: 2,
				checkDate: checkDate,
				ServiceData: CheckTimeServiceData
			}
			jumpToWebPage("settings_CheckTime", JSON.stringify(Extras));


		}
		/**
		 * 监听时间检测数据变化，更新展示并记录
		 */
			window.addEventListener('reshTimeStepVal', function(event) {
			//获得事件参数
				var dataBackTxt = event.detail.dataBackTxt;
			if (event.detail.isCapality == 1) {
				CapCheckTimeServiceData = event.detail.ServiceData;
				document.getElementById('CapabilitiesTimeVal').innerText = dataBackTxt;
			} else if (event.detail.isCapality == 2) {
				CheckTimeServiceData = event.detail.ServiceData;
				document.getElementById('CheckTimeStepVal').innerText = dataBackTxt;
			} else {
				HumanCheckTimeServiceData = event.detail.ServiceData;
				document.getElementById('HumanCheckTimeStepVal').innerText = dataBackTxt;
			}
		});

		/*********************************************运动检测 区域绘制+灵敏度***********************************************/
		/*
		 * 初始化 区域绘制+灵敏度数据
		 */
		function initAreas() {
			//获取检测时间并初始化
			SendAjax(LAPI.DetectionAreas, 'get', function (code, data) {
				if (code == 0) {
					//初始化检测时间
					$("#EZView-content").removeClass("mui-hidden");
					CheckTimeStepChecked = initCheckTime(CheckTimeServiceData);
					document.getElementById("CheckTimeStep").classList.add("mui-navigate-right");
					document.getElementById('CheckTimeStepVal').innerText = CheckTimeStepChecked;
					GridService = deepCopy(data);

          // 接口获取到的灵敏度 数值
					SensitivityVal = data.Sensitivity;
          // 将接口中的灵敏度数值，转换为三个档位
          var gearSensitivityVal = SensitivityValue(SensitivityVal);
          // 根据接口中的灵敏度数值，初始化界面显示
          $('#sensitivity-content input[name="radio1"]').each(function (index, el) {
            if (el.value == gearSensitivityVal) {
              el.checked = true;
            }
          });
          // 在单选框的父元素上，添加 data-value 属性，用于记录当前选中的灵敏度
          $('#sensitivity-content').attr('data-curValue', gearSensitivityVal)
					document.getElementById("CheckArea").classList.add("mui-navigate-right");
					document.getElementById("CheckArea").children[1].style.display = "block"
					dsBridgeFuncSyn.dismiss();
				} else {
					$("#Sensitivity-item div.loadFailed").removeClass("mui-hidden");
					$("#CheckAreaItem div.loadFailed").removeClass("mui-hidden");
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					dsBridgeFuncSyn.dismiss();
				}
			});
		}
		/**
		 * 跳转至绘图页面
		 */
		function CheckArea() {
			var Extras = {
				GridData: GridService
			}
			jumpToWebPage("settings_MotionArea", JSON.stringify(Extras),1);
		}
		/**
		 * 跳转至绘图页面
		 */
		function SmartMotionCheckArea() {
			// TODO:页面跳转+传参
			var Extras = {
				AreaType: 3,
				ZoneGridService: SmartMotionGridService
			}
			jumpToWebPage("settings_ZoneArea", JSON.stringify(Extras),1);
		}

		function stwichStatusChange(status) {
			//1是开启
			if (status) {
				//1是智能模式
				$("#motionMode").removeClass("mui-hidden");
				if (ModeRuleData.Mode) {
					$("#smartModeConfig").removeClass("mui-hidden");
					$("#customModeConfig").addClass("mui-hidden");
				} else {
					$("#customModeConfig").removeClass("mui-hidden");
					$("#smartModeConfig").addClass("mui-hidden");
				}
			} else {
				$("#motionMode").addClass("mui-hidden");
				if (ModeRuleData.Mode) {
					$("#smartModeConfig").addClass("mui-hidden");
				} else {
					$("#customModeConfig").addClass("mui-hidden");
				}
			}
		}
		/**
		 * 下发抓拍目标配置
		 */
		function SmartMotionCaptureTargetOk() {
			var sendData = deepCopy(SmartMotionGridService);
			var TargetList = [];
			mui('#CaptureTargetList input').each(function (index, El) {
				var DetectTargetInitInfo = deepCopy(DetectTargetInfo);
				if (El.checked) {
					var flag = false;
					if (SmartMotionGridService.RECTAreas[0].Num > 0) {
						for (var i = 0; i < CTargetList.length; i++) {
							if (CTargetList[i].Type == Number(El.value)) {
								var item = deepCopy(CTargetList[i]);
								item.Enabled = 1;
								TargetList.push(item);
								flag = true;
							}
						}
					}
					if (!flag) {
						DetectTargetInitInfo.Enabled = 1;
						DetectTargetInitInfo.Type = Number(El.value);
						TargetList.push(DetectTargetInitInfo);
						sendData.RECTAreas[0].Num++;
					}
				} else {
					if (SmartMotionGridService.RECTAreas[0].Num > 0) {
						for (var i = 0; i < CTargetList.length; i++) {
							if (CTargetList[i].Type == El.value) {
								var item = deepCopy(CTargetList[i]);
								item.Enabled = 0;
								TargetList.push(item);
							}
						}
					}
				}
			});
			sendData.RECTAreas[0].DetectTargetList = TargetList;
			dsBridgeFuncSyn.showLoading();
			SendAjax(LAPI.SmartMotionDetectionAreas, 'put', function (code, data) {
				dsBridgeFuncSyn.dismiss();
				if (code == 0) {
					SmartMotionGridService = deepCopy(sendData);
					CTargetList = JSON.parse(JSON.stringify(TargetList));
					setTarget();
				} else {
					for (var i = 0; i < CTargetList.length; i++) {
						mui('#CaptureTargetList input').each(function (index, El) {
							if (CTargetList[i].Enabled == 1 && CTargetList[i].Type == El.value) {
								El.checked = true;
							} else if (CTargetList[i].Enabled == 0 && CTargetList[i].Type == El.value) {
								El.checked = false;
							}
						});
					}
					setTarget();
					showToast(langTip["WEB_toast_modify_favoritesname_failed"] + "(" + code + ")", code);
				}
				mui('#SmartMotionCaptureTarget').popover('toggle');
			}, sendData);
		}

		function getDaycap() {
			SendAjax(LAPI.IPCorChannelCapabilities, 'get', function (code, data) {
				if (code == 0) {
					if (data.SupportLinkageDayNightMode && data.SupportLinkageDayNightMode == 1) {
						SupportLinkageDayNightMode = data.SupportLinkageDayNightMode;
					}
					getAlarmModeData();
				} else {
					$("#EZView-content").addClass("mui-hidden");
					addBitmap(0);
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					dsBridgeFuncSyn.dismiss();
				}
			});
		}

		/*
		* 通道保存报警联动计划
		*/
		function savachl() {
			dsBridgeFuncSyn.showLoading();
			var sendData = getDevSendData();
			SendAjax(AlarmLAPI, 'put', function (code, data) {
				dsBridgeFuncSyn.dismiss();
				if (code == 0) {
					$("#selectAudioStepVal").text(audioName.trim());
					mui('#selectAudio').popover('toggle');
					showToast(langTip["WEB_api_error_succeeded"], code);
				} else {
					configData = JSON.parse(JSON.stringify(saveOrg));
					showToast(langTip["WEB_api_error_operation_fails"], code);
				}
			}, sendData);

		}

		/*
		* 保存IPC告警音配置
		*/
		function save() {
			dsBridgeFuncSyn.showLoading();
			var sendData = getDevSendData();
			SendAjax(AlarmLAPI, 'put', function (code, data) {
				dsBridgeFuncSyn.dismiss();
				if (code == 0) {
					$("#selectAudioStepVal").text(audioName.trim());
					mui('#selectAudio').popover('toggle');
					showToast(langTip["WEB_api_error_succeeded"], code);
				} else {
					configData = JSON.parse(JSON.stringify(saveOrg));
					showToast(langTip["WEB_api_error_operation_fails"], code);
				}
			}, sendData);
		}

		function initAudioAlarmSwtich() {
			/*
			 * 监听声音检测开关
			 */
			document.getElementById("setAudioAlarmSwitch").addEventListener("toggle", function (event) {
				if (event.detail.isActive && setAudioAlarmConfirm) {
					var sendDataON = getDevSendData();
					for (var i = 0; i < sendDataON.Actions.length; i++) {
						if (sendDataON.Actions[i].ActID == 28) {
							sendDataON.Actions[i].Enabled = 1;
						}
					}
					dsBridgeFuncSyn.showLoading();
					SendAjax(AlarmLAPI, 'put', function (code, data) {
						dsBridgeFuncSyn.dismiss();
						if (code == 0) {
							//TODO:
							configData.Actions[0].Enabled = 1;
							$("#alarmModal").removeClass("mui-hidden");
							showToast(langTip["WEB_api_error_succeeded"]);
						} else {
							setAudioAlarmConfirm = false;
							showToast(langTip["WEB_api_error_operation_fails"] + "(" + code + ")", code);
							setTimeout(function () {
								mui("#setAudioAlarmSwitch").switch().toggle();
							}, 200);
						}
					}, sendDataON);
				} else if (!event.detail.isActive && setAudioAlarmConfirm) {
					//TODO:
					$("#alarmModal").addClass("mui-hidden");
					var sendDataOFF = getDevSendData();
					for (var i = 0; i < sendDataOFF.Actions.length; i++) {
						if (sendDataOFF.Actions[i].ActID == 28) {
							sendDataOFF.Actions[i].Enabled = 0;
						}
					}
					dsBridgeFuncSyn.showLoading();
					SendAjax(AlarmLAPI, 'put', function (code, data) {
						dsBridgeFuncSyn.dismiss();
						if (code == 0) {
							configData.Actions[0].Enabled = 0;
							showToast(langTip["WEB_api_error_succeeded"]);
						} else {
							setAudioAlarmConfirm = false;
							showToast(langTip["WEB_api_error_operation_fails"] + "(" + code + ")", code);
							setTimeout(function () {
								mui("#setAudioAlarmSwitch").switch().toggle();
								$("#alarmModal").removeClass("mui-hidden");
							}, 300);
						}
					}, sendDataOFF);
				} else {
					setAudioAlarmConfirm = true;
				};
			});
		}

		function initLightAlarmSwtich() {
			/*
			 * 监听灯光检测开关
			 */
			document.getElementById("setLightAlarmSwitch").addEventListener("toggle", function (event) {
				if (event.detail.isActive && setLightAlarmConfirm) {
					var sendDataON = getDevSendData();
					for (var i = 0; i < sendDataON.Actions.length; i++) {
						if (sendDataON.Actions[i].ActID == 29) {
							sendDataON.Actions[i].Enabled = 1;
						}
					}

					dsBridgeFuncSyn.showLoading();
					SendAjax(AlarmLAPI, 'put', function (code, data) {
						dsBridgeFuncSyn.dismiss();
						if (code == 0) {
							configData.Actions[1].Enabled = 1;
							$("#alarmLightModal").removeClass("mui-hidden");
							showToast(langTip["WEB_api_error_succeeded"]);
						} else {
							setLightAlarmConfirm = false;
							showToast(langTip["WEB_api_error_operation_fails"] + "(" + code + ")", code);
							setTimeout(function () {
								mui("#setLightAlarmSwitch").switch().toggle();
							}, 200);
						}
					}, sendDataON);
				} else if (!event.detail.isActive && setLightAlarmConfirm) {
					$("#alarmLightModal").addClass("mui-hidden");
					var sendDataOFF = getDevSendData();
					for (var i = 0; i < sendDataOFF.Actions.length; i++) {
						if (sendDataOFF.Actions[i].ActID == 29) {
							sendDataOFF.Actions[i].Enabled = 0;
						}
					}
					dsBridgeFuncSyn.showLoading();
					SendAjax(AlarmLAPI, 'put', function (code, data) {
						dsBridgeFuncSyn.dismiss();
						if (code == 0) {
							configData.Actions[1].Enabled = 0;
							showToast(langTip["WEB_api_error_succeeded"]);
						} else {
							setLightAlarmConfirm = false;
							showToast(langTip["WEB_api_error_operation_fails"] + "(" + code + ")", code);
							setTimeout(function () {
								mui("#setLightAlarmSwitch").switch().toggle();
								$("#alarmLightModal").removeClass("mui-hidden");
							}, 300);
						}
					}, sendDataOFF);
				} else {
					setLightAlarmConfirm = true;
				};
			});
		}

		function getAlarmModeData() {
			AlarmLAPI = LAPI.MotionDetectionLinkageActions.replace(/<Mode>/, 1);
			if (localStorage.deviceType == "0" && localStorage.isMultiChannelIPC == "0") {
				AudioFile = LAPI.AudioFile.replace("<ID>", -1);
			} else {
				AudioFile = LAPI.AudioFile;
			}

			SendAjax(AlarmLAPI, 'get', function (code, data) {
				if (code == 0) {
					saveData = JSON.parse(JSON.stringify(data));
					devOrgData = JSON.parse(JSON.stringify(data));
					//初始化声音报警状态，声音报警开关、联动模式、报警音选择
					if (supportAudioAlarm) {
						initAlarmAudio();
					} else {
						initAlarmStatus();
						initPlanCheckSwitch();
						initAudioAlarmData();
						initLightAlarmData();
						mui('.mui-scroll-wrapper').scroll();
						dsBridgeFuncSyn.dismiss();
					}
				} else {
					$("#EZView-content").addClass("mui-hidden");
					addBitmap(0);
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					dsBridgeFuncSyn.dismiss();
				}
			});

		}

		/*
		 * 初始化按钮开关
		 */
		function initPlanCheckSwitch() {
			var AudioFirst = true;
			var LightFirst = true;
			var AudioInfo = configData.Actions[0].ActParam.AudioCustomInfo;
			var LightInfo = configData.Actions[1].ActParam.LightCustomInfo;
			var AudioInfoDayNight = configData.Actions[0].ActParam.AudioDayNightInfo;
			var LightInfoDayNight = configData.Actions[1].ActParam.LightDayNightInfo.LightDayNightPlanInfo;
			for (var z = 1; z < 8; z++) {
				var DayData1 = JSON.parse(JSON.stringify(Day));
				DayData1.ID = z;
				var DayData2 = JSON.parse(JSON.stringify(Day));
				DayData2.ID = z;
				var DayData3 = JSON.parse(JSON.stringify(audioDayNight));
				DayData3.ID = z;
				var DayData4 = JSON.parse(JSON.stringify(lightDayNight));
				DayData4.ID = z;
				for (var m = 0; m < 3; m++) {
					var TimeSectionInfosData1 = JSON.parse(JSON.stringify(AudioTimeSectionInfo));
					var TimeSectionInfosData2 = JSON.parse(JSON.stringify(LightTimeSectionInfo));
					DayData1.Num++;
					DayData2.Num++;
					DayData1.TimeSectionInfos.push(TimeSectionInfosData1);
					DayData2.TimeSectionInfos.push(TimeSectionInfosData2);
				}
				AudioInfo.Days.push(DayData1);
				LightInfo.LightWeekPlanInfo.Days.push(DayData2);
				AudioInfoDayNight.Days.push(DayData3);
				LightInfoDayNight.Days.push(DayData4);
			}
			initDefaulttime();
		}

		function initDefaulttime() {
			for (var j = 0; j < 7; j++) {
				if (supportAudioAlarm) {
					if (devAudioInfo && devAudioInfo.AudioDayNightInfo && devAudioInfo.AudioDayNightInfo.Num > 0) {
						var stasu1 = devAudioInfo.AudioDayNightInfo.Days[0].AudioDayInfo;
						configData.Actions[0].ActParam.AudioDayNightInfo.Days[j].AudioDayInfo = stasu1;
						var stasu2 = devAudioInfo.AudioDayNightInfo.Days[0].AudioNightInfo;
						configData.Actions[0].ActParam.AudioDayNightInfo.Days[j].AudioNightInfo = stasu2;
					}
				}
				if (supportLightAlarm) {
					if (devLightInfo && devLightInfo.LightDayNightInfo && devLightInfo.LightDayNightInfo.LightDayNightPlanInfo.Num > 0) {
						var stasu3 = devLightInfo.LightDayNightInfo.LightDayNightPlanInfo.Days[0].LightDayInfo;
						configData.Actions[1].ActParam.LightDayNightInfo.LightDayNightPlanInfo.Days[j].LightDayInfo = stasu3;
						var stasu4 = devLightInfo.LightDayNightInfo.LightDayNightPlanInfo.Days[0].LightNightInfo;
						configData.Actions[1].ActParam.LightDayNightInfo.LightDayNightPlanInfo.Days[j].LightNightInfo = stasu4;
					}
				}
			}
			if (supportAudioAlarm) {
				if (devAudioInfo.AudioCustomInfo.Num > 0 && devAudioInfo.AudioCustomInfo.Days[0].Num > 0) {
					for (var j = 0; j < 7; j++) {
						var max = devAudioInfo.AudioCustomInfo.Days[0].Num >= 3 ? 3 : devAudioInfo.AudioCustomInfo.Days[0].Num;
						for (var m = 0; m < max; m++) {
							var stasus = devAudioInfo.AudioCustomInfo.Days[0].TimeSectionInfos[m];
							configData.Actions[0].ActParam.AudioCustomInfo.Days[j].TimeSectionInfos[m] = stasus;
						}
					}
				}
			}
			if (supportLightAlarm) {
				if (devLightInfo.LightCustomInfo.LightWeekPlanInfo.Num > 0 && devLightInfo.LightCustomInfo.LightWeekPlanInfo.Days[0].Num > 0) {
					for (var j = 0; j < 7; j++) {
						var max = devLightInfo.LightCustomInfo.LightWeekPlanInfo.Days[0].Num >= 3 ? 3 : devLightInfo.LightCustomInfo.LightWeekPlanInfo.Days[0].Num;
						for (var m = 0; m < max; m++) {
							var stasus = devLightInfo.LightCustomInfo.LightWeekPlanInfo.Days[0].TimeSectionInfos[m];
							configData.Actions[1].ActParam.LightCustomInfo.LightWeekPlanInfo.Days[j].TimeSectionInfos[m] = stasus;
						}
					}
				}
			}

		}

		function initAlarmStatus() {
			for (var i = 0; i < saveData.Actions.length; i++) {
				if (saveData.Actions[i].ActID == 28 && supportAudioAlarm) {
					AudioAlarmCheck = saveData.Actions[i].Enabled;
					document.getElementById("setAudioAlarmSwitch").style.zIndex = 20;
					document.getElementById("setAudioAlarmSwitch").style.visibility = "visible";

					setAudioAlarmConfirm = false;
					setSwitchStatus("setAudioAlarmSwitch", AudioAlarmCheck);
					setAudioAlarmConfirm = true;
					var setAudioAlarmSwitch = document.getElementById("setAudioAlarmSwitch").classList.contains("mui-active");
					if (setAudioAlarmSwitch) {
						document.getElementById("setAudioAlarmCircle").style.transform = 'translate(16px, 0px)';
					}
					devAudioInfo = JSON.parse(JSON.stringify(saveData.Actions[i].ActParam));
					configData.Actions[0].ActParam.TimeMode = Number(JSON.parse(JSON.stringify(devAudioInfo.TimeMode)));
					configData.Actions[0].Enabled = AudioAlarmCheck;
					if (AudioAlarmCheck == 1) {
						$("#alarmModal").removeClass("mui-hidden");
					}
				}
			}
			for (var i = 0; i < saveData.Actions.length; i++) {
				if (saveData.Actions[i].ActID == 29 && supportLightAlarm) {
					LightAlarmCheck = saveData.Actions[i].Enabled;
					document.getElementById("setLightAlarmSwitch").style.zIndex = 20;
					document.getElementById("setLightAlarmSwitch").style.visibility = "visible";

					setLightAlarmConfirm = false;
					setSwitchStatus("setLightAlarmSwitch", LightAlarmCheck);
					setLightAlarmConfirm = true;
					var setLightAlarmSwitch = document.getElementById("setLightAlarmSwitch").classList.contains("mui-active");
					if (setLightAlarmSwitch) {
						document.getElementById("setLightAlarmCircle").style.transform = 'translate(16px, 0px)';
					}
					devLightInfo = JSON.parse(JSON.stringify(saveData.Actions[i].ActParam));
					configData.Actions[1].ActParam.TimeMode = Number(JSON.parse(JSON.stringify(devLightInfo.TimeMode)));
					configData.Actions[1].Enabled = LightAlarmCheck;
					if (LightAlarmCheck == 1) {
						$("#alarmLightModal").removeClass("mui-hidden");
					}
				}
			}
		}

		function initAudioAlarmData() {
			setAudioMode(configData.Actions[0].ActParam, "AudioAlarmModeStepVal");

		}

		function initLightAlarmData() {
			setLightMode(configData.Actions[1].ActParam, "LightAlarmModeStepVal");
		}

		/**
		 * 报警音列表初始化
		 */
		function initAlarmAudio() {
			SendAjax(AudioFile, 'get', function (code, data) {
				if (code == 0) {
					initAlarmStatus();
					initPlanCheckSwitch();
					initAudioAlarmData();
					initLightAlarmData();
					mui('.mui-scroll-wrapper').scroll();
					AlarmAudioList = data.FileInfoList;
					AudioChecked = AlarmAudioList[0].FileName;
					if (SupportLinkageDayNightMode) {
						var nameID = devAudioInfo.AudioDayNightInfo.Days[0].AudioDayInfo.AudioActParamInfo.AudioFileID;
						for (var j = 0; j < AlarmAudioList.length; j++) {
							if (AlarmAudioList[j].ID == nameID) {
								AudioDayNightCheckedarr[0] = AlarmAudioList[j].FileName;
							}
						}
					}

					for (var j = 0; j < AlarmAudioList.length; j++) {
						if (devAudioInfo.AudioCustomInfo.Num > 0 && devAudioInfo.AudioCustomInfo.Days[0].Num > 0 && devAudioInfo.AudioCustomInfo.Days[0].TimeSectionInfos[0]) {
							var nameID = devAudioInfo.AudioCustomInfo.Days[0].TimeSectionInfos[0].AudioActParamInfo.AudioFileID;
							if (AlarmAudioList[j].ID == nameID) {
								AudioCustomCheckedarr[0] = AlarmAudioList[j].FileName;
							}
						} else {
							AudioCustomCheckedarr[0] = AlarmAudioList[0].FileName;
						}
					}

					if (configData.Actions[0].ActParam.TimeMode == 0) {
						document.getElementById('selectAudioStepVal').innerText = AudioCustomCheckedarr[0];
					} else {
						document.getElementById('selectAudioStepVal').innerText = AudioDayNightCheckedarr[0];
					}

					getAudioAlarmList(AlarmAudioList);
					mui('#selectAudioList a').each(function (index, El) {
						if (El.innerText.trim() == AudioChecked) {
							El.parentNode.classList.add('mui-selected');
						}
					});
					backCheckData = JSON.parse(JSON.stringify(configData));
					dsBridgeFuncSyn.dismiss();
				} else {
					$("#EZView-content").addClass("mui-hidden");
					addBitmap(0);
					showToast(langTip["WEB_loadFailed"] + "(" + code + ")", code);
					dsBridgeFuncSyn.dismiss();
				}
			})
		}

		/*
		 * 获取告警音列表
		 */
		function getAudioAlarmList(data) { // 报警音列表在页面中显示
			var selectAudioListItem = document.getElementById('selectAudioListItem');
			if (data.length <= 5) {
				selectAudioListItem.style.height = 50 * data.length + "px";
			} else {
				selectAudioListItem.style.height = 50 * 5 + "px";
			}
			var selectAudioList = document.getElementById('selectAudioList');
			for (var i = 0; i < data.length; i++) {
				var item = document.createElement('li');
				item.className = 'mui-table-view-cell installType';
				item.innerHTML = '<a class="mui-navigate-right" data-id=' + data[i].ID + ' data-value=' + i + '>&nbsp;' + data[i].FileName + '</a>';
				selectAudioList.appendChild(item);
			}
		}

		function setAudioMode(dayData, elID) {
			var modeType;
			if (dayData.TimeMode == 0) {
				modeType = langTip["WEB_CustomMode"];
			} else {
				var enabledDay = false;
				var enabledNight = false;
				if (dayData.AudioDayNightInfo.Days[0].AudioDayInfo.Enabled == 1) {
					enabledDay = true;
				}
				if (dayData.AudioDayNightInfo.Days[0].AudioNightInfo.Enabled == 1) {
					enabledNight = true;
				}
				if (enabledDay == false && enabledNight == false) {
					modeType = langTip["WEB_DayNight"];
				} else if (enabledDay == true && enabledNight == false) {
					modeType = langTip["WEB_DayNight"] + "(" + langTip["WEB_dayTime"] + ")";
				} else if (enabledDay == false && enabledNight == true) {
					modeType = langTip["WEB_DayNight"] + "(" + langTip["WEB_nightTime"] + ")";
				} else {
					modeType = langTip["WEB_DayNight"] + "(" + langTip["WEB_all_day"] + ")";
				}
			}
			$("#" + elID).text(modeType);
		}

		function setLightMode(dayData, elID) {
			var modeType;
			if (dayData.TimeMode == 0) {
				modeType = langTip["WEB_CustomMode"];
			} else {
				var enabledDay = false;
				var enabledNight = false;
				if (dayData.LightDayNightInfo.LightDayNightPlanInfo.Days[0].LightDayInfo.Enabled == 1) {
					enabledDay = true;
				}
				if (dayData.LightDayNightInfo.LightDayNightPlanInfo.Days[0].LightNightInfo.Enabled == 1) {
					enabledNight = true;
				}
				if (enabledDay == false && enabledNight == false) {
					modeType = langTip["WEB_DayNight"];
				} else if (enabledDay == true && enabledNight == false) {
					modeType = langTip["WEB_DayNight"] + "(" + langTip["WEB_dayTime"] + ")";
				} else if (enabledDay == false && enabledNight == true) {
					modeType = langTip["WEB_DayNight"] + "(" + langTip["WEB_nightTime"] + ")";
				} else {
					modeType = langTip["WEB_DayNight"] + "(" + langTip["WEB_all_day"] + ")";
				}
			}
			$("#" + elID).text(modeType);
		}
		/**
		 * 报警音确定
		 */
		function selectAudioListOk() {
			var audioID;
			var AudioInfo = configData.Actions[0].ActParam;
			mui("#selectAudioList li").each(
				function (index, El) {
					if ($(El).hasClass("mui-selected")) {
						audioID = El.children[0].getAttribute("data-id");
						audioName = El.children[0].innerText;
					}
				}
			);
			saveOrg = JSON.parse(JSON.stringify(configData));

			if (SupportLinkageDayNightMode == 1) {
				for (var z = 0; z < 7; z++) {
					AudioInfo.AudioDayNightInfo.Days[z].AudioDayInfo.AudioActParamInfo.AudioFileID = Number(audioID);
				}

				for (var z = 0; z < 7; z++) {
					AudioInfo.AudioDayNightInfo.Days[z].AudioNightInfo.AudioActParamInfo.AudioFileID = Number(audioID);
				}
			}

			for (var i = 0; i < 3; i++) {
				for (var z = 0; z < 7; z++) {
					AudioInfo.AudioCustomInfo.Days[z].TimeSectionInfos[i].AudioActParamInfo.AudioFileID = Number(audioID);
				}
			}

			if (localStorage.deviceType == "0") {
				save();
			} else {
				savachl();
			}
		}

		function getIPCsendData() {
			var sendData = JSON.parse(JSON.stringify(devOrgData));
			var AudioFirst = true;
			var LightFirst = true;
			var AudioDayNightFirst = true;
			var LightDayNightFirst = true;
			var AudioInfo = configData.Actions[0].ActParam.AudioCustomInfo;
			var LightInfo = configData.Actions[1].ActParam.LightCustomInfo;
			for (var i = 0; i < sendData.Num; i++) {
				if (sendData.Actions[i].ActID == 28) {
					var sendAudioInfo = sendData.Actions[i].ActParam.AudioCustomInfo;
					var sendAudioDayNightInfo = sendData.Actions[i].ActParam.AudioDayNightInfo;
					var AudioDayNightInfo = configData.Actions[0].ActParam.AudioDayNightInfo;
					if (sendAudioDayNightInfo) {
						AudioDayNightFirst = false;
					}
					if (sendAudioInfo) {
						AudioFirst = false;
					}
					sendData.Actions[i].ActParam.TimeMode = configData.Actions[0].ActParam.TimeMode;
					sendData.Actions[i].Enabled = configData.Actions[0].Enabled;
					for (var m = 0; m < 7; m++) {
						var numberOfcycles = sendAudioInfo.Days[m].Num < 3 ? 3 : sendAudioInfo.Days[m].Num;
						var orangeNum = sendAudioInfo.Days[m].Num;
						for (var n = 0; n < numberOfcycles; n++) {
							if (n < 3) {
								if (n < orangeNum) {
									sendAudioInfo.Days[m].TimeSectionInfos[n].AudioActParamInfo.AudioFileID = AudioInfo.Days[m].TimeSectionInfos[n].AudioActParamInfo.AudioFileID;
									sendAudioInfo.Days[m].TimeSectionInfos[n].Enabled = AudioInfo.Days[m].TimeSectionInfos[n].Enabled;
									sendAudioInfo.Days[m].TimeSectionInfos[n].Begin = AudioInfo.Days[m].TimeSectionInfos[n].Begin;
									sendAudioInfo.Days[m].TimeSectionInfos[n].End = AudioInfo.Days[m].TimeSectionInfos[n].End;
								} else {
									if (!sendAudioInfo.Days[m].TimeSectionInfos) {
										sendAudioInfo.Days[m].TimeSectionInfos = [];

									}
									sendAudioInfo.Days[m].Num++;
									sendAudioInfo.Days[m].TimeSectionInfos.push(AudioInfo.Days[m].TimeSectionInfos[n]);
								}
							} else {
								sendAudioInfo.Days[m].TimeSectionInfos[n].Begin = "00:00:00";
								sendAudioInfo.Days[m].TimeSectionInfos[n].End = "00:00:00";
							}
						}
						//获取日夜模式其他配置原数据
						if (!AudioDayNightFirst) {
							sendAudioDayNightInfo.Days[m].AudioDayInfo.Enabled = AudioDayNightInfo.Days[m].AudioDayInfo.Enabled;
							sendAudioDayNightInfo.Days[m].AudioNightInfo.Enabled = AudioDayNightInfo.Days[m].AudioNightInfo.Enabled;
							sendAudioDayNightInfo.Days[m].AudioDayInfo.AudioActParamInfo.AudioFileID = AudioDayNightInfo.Days[m].AudioDayInfo.AudioActParamInfo.AudioFileID;
							sendAudioDayNightInfo.Days[m].AudioNightInfo.AudioActParamInfo.AudioFileID = AudioDayNightInfo.Days[m].AudioNightInfo.AudioActParamInfo.AudioFileID;
						}
					}
					if (AudioDayNightFirst) {
						sendData.Actions[i].ActParam.AudioDayNightInfo = configData.Actions[0].ActParam.AudioDayNightInfo;
					}
				}
				if (sendData.Actions[i].ActID == 29) {
					var sendLightInfo = sendData.Actions[i].ActParam.LightCustomInfo;
					var sendLightDayNightInfo = sendData.Actions[i].ActParam.LightDayNightInfo;
					var LightDayNightInfo = configData.Actions[1].ActParam.LightDayNightInfo;
					if (sendLightDayNightInfo) {
						LightDayNightFirst = false;
					}
					if (sendLightInfo) {
						LightFirst = false;
					}
					sendData.Actions[i].ActParam.TimeMode = configData.Actions[1].ActParam.TimeMode;
					sendData.Actions[i].Enabled = configData.Actions[1].Enabled;
					for (var m = 0; m < 7; m++) {
						var numberOfcycles = sendLightInfo.LightWeekPlanInfo.Days[m].Num < 3 ? 3 : sendLightInfo.LightWeekPlanInfo.Days[m].Num;
						var orangeNum = sendLightInfo.LightWeekPlanInfo.Days[m].Num;
						for (var n = 0; n < numberOfcycles; n++) {
							if (n < 3) {
								if (n < orangeNum) {
									sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Enabled = LightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Enabled;
									sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Begin = LightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Begin;
									sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].End = LightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].End;
								} else {
									if (!sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos) {
										sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos = [];

									}
									sendLightInfo.LightWeekPlanInfo.Days[m].Num++;
									sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos.push(LightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n]);
								}
							} else {
								sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Begin = "00:00:00";
								sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].End = "00:00:00";
							}
						}
						//获取日夜模式其他配置原数据
						if (!LightDayNightFirst) {
							sendLightDayNightInfo.LightDayNightPlanInfo.Days[m].LightDayInfo.Enabled = LightDayNightInfo.LightDayNightPlanInfo.Days[m].LightDayInfo.Enabled;
							sendLightDayNightInfo.LightDayNightPlanInfo.Days[m].LightNightInfo.Enabled = LightDayNightInfo.LightDayNightPlanInfo.Days[m].LightNightInfo.Enabled;
						}
					}
					if (LightDayNightFirst) {
						sendData.Actions[i].ActParam.LightDayNightInfo = configData.Actions[1].ActParam.LightDayNightInfo;
					}
				}
			}
			if (AudioFirst && supportAudioAlarm) {
				var AudioInfo = configData.Actions[0].ActParam.AudioCustomInfo;
				for (var z = 1; z < 8; z++) {
					var DayData1 = JSON.parse(JSON.stringify(Day));
					DayData1.ID = z;
					var TimeSectionInfosData1 = JSON.parse(JSON.stringify(AudioTimeSectionInfo));
					DayData1.Num++;
					DayData1.TimeSectionInfos.push(TimeSectionInfosData1);
					AudioInfo.Days.push(DayData1);
				}
				sendData.Actions.push(configData.Actions[0]);
				sendData.Num++;
			}
			if (LightFirst && supportLightAlarm) {
				var LightInfo = configData.Actions[1].ActParam.LightCustomInfo;
				for (var z = 1; z < 8; z++) {
					var DayData2 = JSON.parse(JSON.stringify(Day));
					DayData2.ID = z;
					var TimeSectionInfosData2 = JSON.parse(JSON.stringify(LightTimeSectionInfo));
					DayData2.Num++;
					DayData2.TimeSectionInfos.push(TimeSectionInfosData2);
					LightInfo.LightWeekPlanInfo.Days.push(DayData2);
				}
				sendData.Actions.push(configData.Actions[1]);
				sendData.Num++;
			}
			for (var i = 0; i < sendData.Num; i++) {
				if (sendData.Actions[i].ActID == 28) {
					if (SupportLinkageDayNightMode != 1) {
						delete sendData.Actions[i].ActParam.AudioDayNightInfo;
					}
				}
				if (sendData.Actions[i].ActID == 29) {
					if (SupportLinkageDayNightMode != 1) {
						delete sendData.Actions[i].ActParam.LightDayNightInfo;
					}
				}
			}
			return sendData;
		}

		function getNVRChannelsendData() {
			var sendData = JSON.parse(JSON.stringify(devOrgData));
			var AudioFirst = true;
			var LightFirst = true;
			var AudioDayNightFirst = true;
			var LightDayNightFirst = true;
			var AudioInfo = configData.Actions[0].ActParam.AudioCustomInfo;
			var LightInfo = configData.Actions[1].ActParam.LightCustomInfo;
			for (var i = 0; i < sendData.Num; i++) {
				if (sendData.Actions[i].ActID == 28) {
					var sendAudioInfo = sendData.Actions[i].ActParam.AudioCustomInfo;
					var sendAudioDayNightInfo = sendData.Actions[i].ActParam.AudioDayNightInfo;
					var AudioDayNightInfo = configData.Actions[0].ActParam.AudioDayNightInfo;
					if (sendAudioDayNightInfo) {
						AudioDayNightFirst = false;
					}
					if (sendAudioInfo) {
						AudioFirst = false;
					}
					sendData.Actions[i].ActParam.TimeMode = configData.Actions[0].ActParam.TimeMode;
					sendData.Actions[i].Enabled = configData.Actions[0].Enabled;
					sendAudioInfo.Days.Num = 8;
					for (var m = 0; m < 7; m++) {
						var numberOfcycles = sendAudioInfo.Days[m].Num < 3 ? 3 : sendAudioInfo.Days[m].Num;
						var orangeNum = sendAudioInfo.Days[m].Num;
						for (var n = 0; n < numberOfcycles; n++) {
							if (n < 3) {
								if (n < orangeNum) {
									sendAudioInfo.Days[m].TimeSectionInfos[n].AudioActParamInfo.AudioFileID = AudioInfo.Days[m].TimeSectionInfos[n].AudioActParamInfo.AudioFileID;
									sendAudioInfo.Days[m].TimeSectionInfos[n].Enabled = AudioInfo.Days[m].TimeSectionInfos[n].Enabled;
									sendAudioInfo.Days[m].TimeSectionInfos[n].Begin = AudioInfo.Days[m].TimeSectionInfos[n].Begin;
									sendAudioInfo.Days[m].TimeSectionInfos[n].End = AudioInfo.Days[m].TimeSectionInfos[n].End;
								} else {
									if (!sendAudioInfo.Days[m].TimeSectionInfos) {
										sendAudioInfo.Days[m].TimeSectionInfos = [];

									}
									sendAudioInfo.Days[m].Num++;
									sendAudioInfo.Days[m].TimeSectionInfos.push(AudioInfo.Days[m].TimeSectionInfos[n]);
								}
							} else {
								sendAudioInfo.Days[m].TimeSectionInfos[n].Begin = "00:00:00";
								sendAudioInfo.Days[m].TimeSectionInfos[n].End = "00:00:00";
							}
						}
						if (!AudioDayNightFirst) {
							sendAudioDayNightInfo.Days[m].AudioDayInfo.Enabled = AudioDayNightInfo.Days[m].AudioDayInfo.Enabled;
							sendAudioDayNightInfo.Days[m].AudioNightInfo.Enabled = AudioDayNightInfo.Days[m].AudioNightInfo.Enabled;
							sendAudioDayNightInfo.Days[m].AudioDayInfo.AudioActParamInfo.AudioFileID = AudioDayNightInfo.Days[m].AudioDayInfo.AudioActParamInfo.AudioFileID;
							sendAudioDayNightInfo.Days[m].AudioNightInfo.AudioActParamInfo.AudioFileID = AudioDayNightInfo.Days[m].AudioNightInfo.AudioActParamInfo.AudioFileID;
						}
					}
					if (AudioDayNightFirst) {
						sendData.Actions[i].ActParam.AudioDayNightInfo = configData.Actions[0].ActParam.AudioDayNightInfo;
					}
				}
				if (sendData.Actions[i].ActID == 29) {
					var sendLightInfo = sendData.Actions[i].ActParam.LightCustomInfo;
					var sendLightDayNightInfo = sendData.Actions[i].ActParam.LightDayNightInfo;
					var LightDayNightInfo = configData.Actions[1].ActParam.LightDayNightInfo;
					if (sendLightDayNightInfo) {
						LightDayNightFirst = false;
					}
					if (sendLightInfo) {
						LightFirst = false;
					}
					sendData.Actions[i].ActParam.TimeMode = configData.Actions[1].ActParam.TimeMode;
					sendData.Actions[i].Enabled = configData.Actions[1].Enabled;
					sendAudioInfo.Days.Num = 8;
					for (var m = 0; m < 7; m++) {
						var numberOfcycles = sendLightInfo.LightWeekPlanInfo.Days[m].Num < 3 ? 3 : sendLightInfo.LightWeekPlanInfo.Days[m].Num;
						var orangeNum = sendLightInfo.LightWeekPlanInfo.Days[m].Num;
						for (var n = 0; n < numberOfcycles; n++) {
							if (n < 3) {
								if (n < orangeNum) {
									sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Enabled = LightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Enabled;
									sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Begin = LightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Begin;
									sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].End = LightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].End;
								} else {
									if (!sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos) {
										sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos = [];

									}
									sendLightInfo.LightWeekPlanInfo.Days[m].Num++;
									sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos.push(LightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n]);
								}
							} else {
								sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].Begin = "00:00:00";
								sendLightInfo.LightWeekPlanInfo.Days[m].TimeSectionInfos[n].End = "00:00:00";
							}
						}
						if (!LightDayNightFirst) {
							sendLightDayNightInfo.LightDayNightPlanInfo.Days[m].LightDayInfo.Enabled = LightDayNightInfo.LightDayNightPlanInfo.Days[m].LightDayInfo.Enabled;
							sendLightDayNightInfo.LightDayNightPlanInfo.Days[m].LightNightInfo.Enabled = LightDayNightInfo.LightDayNightPlanInfo.Days[m].LightNightInfo.Enabled;
						}
					}
					if (LightDayNightFirst) {
						sendData.Actions[i].ActParam.LightDayNightInfo = configData.Actions[1].ActParam.LightDayNightInfo;
					}
				}
			}
			if (AudioFirst && supportAudioAlarm) {
				sendData.Actions.push(configData.Actions[0]);
				sendData.Num++;
			}
			if (LightFirst && supportLightAlarm) {
				sendData.Actions.push(configData.Actions[1]);
				sendData.Num++;
			}
			for (var i = 0; i < sendData.Num; i++) {
				if (sendData.Actions[i].ActID == 28) {
					if (SupportLinkageDayNightMode != 1) {
						delete sendData.Actions[i].ActParam.AudioDayNightInfo;
					}
				}
				if (sendData.Actions[i].ActID == 29) {
					if (SupportLinkageDayNightMode != 1) {
						delete sendData.Actions[i].ActParam.LightDayNightInfo;
					}
				}
			}
			return sendData;
		}

		function getDevSendData() {
			if (localStorage.deviceType == "0") {
				return getIPCsendData();
			} else {
				return getNVRChannelsendData();
			}
		}

		function setTarget() {
			var tarList = [];
			mui('#CaptureTargetList input').each(function (index, El) {
				console.log(El);
				console.log(El.checked);
				if (El.checked) {
					tarList.push(El.previousElementSibling.innerText.trim());
				}
			});
			var str = "";
			for (var i = 0; i < tarList.length; i++) {
				if (i == 0) {
					str = tarList[i];
				} else {
					str = str + "、" + tarList[i];
				}
			}
			document.getElementById("IntrusionDetectionCaptureTargetItemStepVal").innerText = str;
		}

		/**
		 * 监听运动检测绘图数据变化，并记录
		 */
			window.addEventListener('updateGrid', function(event) {
				//获得事件参数
				var Grid_Bak = event.detail.Grid_Bak;
				GridService["Grid"] = Grid_Bak;
			});

		window.addEventListener('updateGrid', function (event) {
			//获得事件参数
			var Grid_Bak = event.detail.Grid_Bak;
			GridService["Grid"] = Grid_Bak;
			});
			/******************新增原生App上报Web功能接口******************/
			dsBridge.register("callWebDoFuncAsyn", function(args) {
				var webInfo = JSON.parse(args);
				for(var key in webInfo) {
					switch(webInfo[key].whichInfo) {
						case "updateGrid": // 绘图数据发还给运检测配置页面
							var param = JSON.parse(webInfo[key].infoValue);
						if (ModeRuleData && ModeRuleData.Mode == 1) {
							SmartMotionGridService = param.Grid_Bak;
						} else {
							GridService["Grid"] = param.Grid_Bak;
						}
						case "reshTimeStepVal": //监听checkTime页面发送的消息 更新时间数据
							var param = JSON.parse(webInfo[key].infoValue);
							var dataBackTxt = param.dataBackTxt;
							if(param.isCapality == 1) {
								CapCheckTimeServiceData = param.ServiceData;
								document.getElementById('CapabilitiesTimeVal').innerText = dataBackTxt;
							} else if(param.isCapality == 2) {
								CheckTimeServiceData = param.ServiceData;
								document.getElementById('CheckTimeStepVal').innerText = dataBackTxt;
							} else {
								HumanCheckTimeServiceData = param.ServiceData;
								document.getElementById('HumanCheckTimeStepVal').innerText = dataBackTxt;
						}
						break;
					case "updateConfigData": // 报警联动数据还给运检测配置页面
						var param = JSON.parse(webInfo[key].infoValue);
						configData = JSON.parse(JSON.stringify(param.configData));
						if (param.ActID == 0) {
							initAudioAlarmData();
						} else {
							initLightAlarmData();
						}
						var showAudio;
						if (configData.Actions[0].ActParam.TimeMode == 0) {
							for (var j = 0; j < AlarmAudioList.length; j++) {
								if (configData.Actions[0].ActParam.AudioCustomInfo.Num > 0 && configData.Actions[0].ActParam.AudioCustomInfo.Days[0].Num > 0 && configData.Actions[0].ActParam.AudioCustomInfo.Days[0].TimeSectionInfos[0]) {
									var nameID = configData.Actions[0].ActParam.AudioCustomInfo.Days[0].TimeSectionInfos[0].AudioActParamInfo.AudioFileID;
									if (AlarmAudioList[j].ID == nameID) {
										showAudio = AlarmAudioList[j].FileName;
									}
								} else {
									showAudio = AlarmAudioList[0].FileName;
								}
							}
							document.getElementById('selectAudioStepVal').innerText = showAudio;
						} else {
							var nameID = configData.Actions[0].ActParam.AudioDayNightInfo.Days[0].AudioDayInfo.AudioActParamInfo.AudioFileID;
							for (var j = 0; j < AlarmAudioList.length; j++) {
								if (AlarmAudioList[j].ID == nameID) {
									showAudio = AlarmAudioList[j].FileName;
								}
							}
							document.getElementById('selectAudioStepVal').innerText = showAudio;
							}
							break;
						case "deviceStatus": // 更新设备在线状态
							localStorage.deviceStatus = webInfo[key].infoValue;
							break;
						case "ip": // 更新ip
							localStorage.Ip = webInfo[key].infoValue;
							break;
						case "port": // 更新port
							localStorage.Port = webInfo[key].infoValue;
							break;
						case "logInfo": //更新登录信息
							localStorage.logInfo = webInfo[key].infoValue;
							break;
						case "deviceName": //更新设备名称
							var deviceName = document.getElementById("deviceName");
							break;
						case "sdkType": //更新SDK类型
							localStorage.sdkType = webInfo[key].infoValue;
							break;
						case "isNetConnect": //更新手机是否联网
							localStorage.isNetConnect = webInfo[key].infoValue;
							break;
						case "hasNewVersion": //是否有新版本
							localStorage.hasNewVersion = webInfo[key].infoValue;
							break;
						case "versionNumber": //当前版本号
							localStorage.versionNumber = webInfo[key].infoValue;
							break;
						case "LocalDeviceUname": //免注册设备用户名更新
							localStorage.LocalDeviceUname = webInfo[key].infoValue;
							break;
						case "deviceOs": //设备云端在线状态 “true”在线，“false”离线
							localStorage.deviceOs = webInfo[key].infoValue;
							break;
						case "updateChannelName": // TODO：通道名称修改成功后，主页同步更新
							localStorage.deviceName = webInfo[key].infoValue;
							break;
						case "workingStatus":
							localStorage.workingStatus = webInfo[key].infoValue;
							break;
						case "channelStatus":
							localStorage.channelStatus = webInfo[key].infoValue;
							break;
						default:
							break;
					}
				}
			})
		</script>
	</body>

</html>