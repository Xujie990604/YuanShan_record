# http基础

## URL和URI

### 协议方案

* 常见的有http协议和ftp协议

### URI和URL的区别

* URL是URI的子集，URL是URI的一种
* URI是统一资源标识符，统一资源标识符用于标示一个抽象或者物理资源。是以一种抽象的，高层次概念定义统一资源标识。
* URL是统一资源定位符，也是能够标识唯一的一个资源，不过是标识资源的地址。通过URL能够找到这个资源
* URI像是身份证号，唯一标识一个人，但是通过身份证号你找不到这个人。URL像是身份证里面的地址。也唯一标识了你这个人，并且能根据URL去找你。

### URI的格式

  ```http://user:pass@www.example.jp:80/dir/index.html?uid=1#ch1```

* 协议 http不区别大小写
* 登录认证 user：pass 可选项
* 服务器地址 www.example.jp 可以是域名，也可以是IPV4 IPV6 必选项
* 服务器端口号 80 默认端口号
* 带层次的文件路径 /dir/index.html
* 查询字符串 ?uid=1 可选
* 片段标识符 ch1 可选

## http协议

### http协议是无状态的

* HTTP协议自身不对请求和响应之间的通信状态进行保存和管理。
* Cookie会根据从服务器端发送的响应报文内的一个叫做Set-Cookie的首部字段信息，通知客户端保存Cookie。当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入Cookie值后发送出去。
* 服务器端发现客户端发送过来的Cookie后，会去检查究竟是从哪一个客户端发来的连接请求，然后对比服务器上的记录，最后得到之前的状态信息。
* Cookie是一种对无状态的HTTP进行状态化的技术。

### http的方法

* get方法 拥有获取资源
* post方法 用于传输实体主体
* put方法 用于传输文件
* delete方法 用于删除文件
* options方法 用于查询支持的方法

### http持久连接

* 无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。早期这么做的原因是请求资源少，追求快。后来通过Connection: Keep-Alive实现长连接

### http的管线化

* 持久连接使得多数请求以管线化（pipelining）方式发送成为可能。从前发送请求后需等待并收到响应，才能发送下一个请求。管线化技术出现后，不用等待响应亦可直接发送下一个请求。这样就能够做到同时并行发送多个请求，而不需要一个接一个地等待响应了

## http报文

### 请求报文

* 请求报文是由请求行(请求方法+ 请求URL+ 协议版本)+ 首部字段 + 报文实体

### 响应报文

* 响应报文是由状态行(协议版本+ 状态码 + 状态码原因短语) + 首部字段 + 报文主体

## http的状态码

* 状态码的类别

    1. 1XX 信息状态码 接收的请求正在处理
    2. 2XX 成功状态码 请求正常处理完毕
    3. 3XX 重定向状态码 需要进行附加操作以完成请求
    4. 4XX 客户端错误状态码 服务器无法处理请求
    5. 5XX 服务器状态码 服务器处理请求出错

### 比较典型的状态码

* 200 ok 表示从客户端发来的请求在服务器端被正常处理了。
* 204 no content 一般在只需要从客户端往服务器发送信息，而对客户端不需要发送新信息内容的情况下使用
* 206 Partial Content 该状态码表示客户端进行了范围请求
* 301 Moved Permanently 永久性重定向。该状态码表示请求的资源已被分配了新的URI，以后应使用资源现在所指的URI
* 302 Found 临时性重定向
* 303 See Other 该状态码表示由于请求对应的资源存在着另一个URI，应使用GET方法定向获取请求的资源。
* 304 Not Modified 该状态码表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但因发生请求未满足条件的情况
* 400 Bad Request 该状态码表示请求报文中存在语法错误
* 401 Unauthorized 该状态码表示发送的请求需要有通过HTTP认证的认证信息。另外若之前已进行过1次请求，则表示用户认证失败。
* 403 Forbidden 该状态码表明对请求资源的访问被服务器拒绝了。服务器端没有必要给出拒绝的详细理由
* 404 Not Found 该状态码表明服务器上无法找到请求的资源
* 500 Internal Server Error 该状态码表明服务器端在执行请求时发生了错误。也有可能是Web应用存在的bug或某些临时的故障。
* 503 Service Unavailable 该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法处理请求

## 和http协作的Web服务器

### 虚拟主机多个域名

* HTTP/1.1规范允许一台HTTP服务器搭建多个Web站点。比如，提供Web托管服务的供应商，可以用一台服务器为多位客户服务，也可以以每位客户持有的域名运行各自不同的网站。这是因为利用了虚拟主机的功能
* 在相同的IP地址下，由于虚拟主机可以寄存多个不同主机名和域名的Web网站，因此在发送HTTP请求时，必须在Host首部内完整指定主机名或域名的URI。

### 通信数据转发程序

* 代理

代理是一种有转发功能的应用程序，它扮演了位于服务器和客户端“中间人”的角色，接收由客户端发送的请求并转发给服务器，同时也接收服务器返回的响应并转发给客户端。
缓存是指代理服务器或客户端本地磁盘内保存的资源副本。利用缓存可减少对源服务器的访问，因此也就节省了通信流量和通信时间。

* 网关

网关是转发其他服务器通信数据的服务器，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。

* 隧道

隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序

## http首部

## http https

### http的不足

* 通信使用明文(不加密),内容可能会被窃听
* 不验证通信方的身份,因此有可能遭遇伪装
* 无法证明报文的完整性,所以有可能已遭篡改

### https

* HTTP 协议中没有加密机制,但可以通过SSL或 TLS(的组合使用,加密 HTTP 的通信内容。属于通信加密，即在整个通信线路中加密
* 用SSL建立安全通信线路之后，就可以在这条线路上进行HTTP通信了。与SSL组合使用的HTTP被称为HTTPS
* HTTP + 加密 + 认证 + 完整性保护 = HTTPS
* HTTPS是身披SSL外壳的HTTP
* HTTPS并非是应用层的一种新协议。只是HTTP通信接口部分用SSL和TLS协议代替而已。
* HTTPS 采用共享密钥加密（对称）和公开密钥加密（非对称）两者并用的混合加密机制。若密钥能够实现安全交换,那么有可能会考虑仅使用公开密钥加密来通信。但是公开密钥加密与共享密钥加密相比,其处理速度要慢。所以应充分利用两者各自的优势, 将多种方法组合起来用于通信。 在交换密钥阶段使用公开密钥加密方式,之后的建立通信交换报文阶段 则使用共享密钥加密方式
* HTTPS也存在一些问题，那就是当使用SSL时，它的处理速度会变慢。
* SSL的慢分两种。一种是指通信慢。另一种是指由于大量消耗CPU及内存等资源，导致处理速度变慢

## 认证

### SSL客户端认证

* 采用证书认证和表单认证相结合的双因素认证模式
* 证书认证用来认证你客户端计算机
* 表单认证用来认证这是本人的操作
* 证书认证需要为证书提供一定的费用

### 表单认证

* 十分普及的一种方式
* 早期需要配合cookie进行使用