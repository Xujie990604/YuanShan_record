# 网络资料

## 转发的基础知识

### 二层转发(常见的二层转发设备：网桥)

1. 二层转发，物理层，链路层。
2. 通过MAC地址转发，广播域是所有的端口
3. 根据接收到的数据帧的目的MAC地址，把报文从相应的端口转发出去
4. 为了限制广播范围。进行VLAN划分。

#### 二层转发的一般流程

1. 读取MAC地址(学到MAC表中)
2. 读取目的MAC地址，然后查MAC表转发(源目的MAC同一端口则丢弃)
3. 如果MAC表无此表项，则广播（？？？每个二层转发的设备都要保留所有设备的MAC地址吗）
4. 等目的主机回应后，将目的主机MAC（即回应报文的源MAC）学到MAC表中(后续数据不再广播)

#### VLAV

* 为了限制广播域的大小，对网络进行了划分(每个网络都是一个VLAN)，只在当前VLAN中广播
* 缺点是不同的VLAN无法二层通信

### 三层转发(常见的三层转发设备： 路由器)

1. 三层转发，物理层，链路层，网络层
2. 转发方式： 按照IP地址寻找路由，转发数据
3. 有效隔离广播域。一个端口就是一个广播域

#### A ping B

1. A检查报文的目的IP地址（B），发现不再同一个网段 (如果在同一个网段的话就是二层转发了)
2. A查找ARP地址表获得网关（R）的MAC地址。(网关就是一个网络连接另一个网络的设备)
3. A向路由器R发送报文(1.目的MAC： 路由器连接A的口的MAC 2.源MAC：A的MAC 3. 目的ip是B，源IP是A)
4. 路由器R收到之后，进行IP转发处理，获取下一跳到B的IP地址
5. R查找ARP获得B的MAC地址
6. R向B转发A的请求报文（1.目的MAC： 下一跳B的MAC 2.源MAC： R连接B的口的MAC 3.目的IP是B，源IP是A）

## TCP/IP协议

* MAC地址： 物理地址，二层地址
* IP地址： 逻辑地址，三层地址
* ARP协议（属于数据链路层的协议）： 地址解析协议 IP  -- > MAC
* RARP协议（属于数据链路层的协议）： 地址解析协议 MAC  -- > IP
* ping程序：是对两个TCP/IP系统连通性进行测试的基本工具

## 其他

* 公网IP： 例如百度的IP地址就是一个公网IP。公网IP可以被直接访问。
* 私网IP： 因为公网IP不够用，所以好多设备共有一个公网IP，由路由器进行私网IP的分配。私网IP不能被(不是同一个网段)的设备直接访问。(我们平时使用的PC不能直接被当做服务器使用就是因为家用PC没有自己的公网IP)
