# 响应式系统

## 副作用函数

* 函数在正常工作任务之外对外部环境造成了影响

## 简易的响应式系统

```js
// 用来存储副作用的桶
const subs = new Set()
// 原始的数据
const obj = {
  name: 'xujie'
}
// 将原始数据的读写进行代理拦截
const myObj = new Proxy(obj, {
  // 拦截读取的操作
  get(target, key) {
    // 将副作用函数存入桶中
    subs.add(effect)
    return target[key]
  },
  // 拦截设置属性的操作
  set(target, key, newVal) {
    target[key] = newVal
    // 执行桶中的所有函数
    subs.forEach(cb => cb())
    return true
  }
}
// 副作用函数
function effect() {
  document.body.innerText = myObj.name

// 执行副作用函数，触发属性的读取,将当前副作用函数添加到桶中
effect(
// 两秒后进行数据的更新
setTimeout(() => {
  myObj.name = 'xiaohan'
}, 2000)
```
